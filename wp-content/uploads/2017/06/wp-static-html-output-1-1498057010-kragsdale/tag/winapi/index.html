<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<base href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io" />

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">



<title>winapi Archives - Kevin Ragsdale</title>

<!-- This site is optimized with the Yoast SEO plugin v4.9 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/winapi/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="object" />
<meta property="og:title" content="winapi Archives - Kevin Ragsdale" />
<meta property="og:url" content="kevinragsdale.github.io/tag/winapi/" />
<meta property="og:site_name" content="Kevin Ragsdale" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />



		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='editor-style-css'  href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/themes/editor/style.css?ver=4.8' type='text/css' media='all' />
<link rel='stylesheet' id='editor-font-awesome-css-css'  href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/themes/editor/inc/fontawesome/font-awesome.css?ver=4.1.0' type='text/css' media='screen' />
<!--[if IE]>
<link rel='stylesheet' id='ie7-style-css'  href='kevinragsdale.github.io/wp-content/themes/editor/inc/styles/ie.css?ver=4.8' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='editor-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C600%2C700%2C400italic%2C600italic%2C700italic%7CRoboto+Condensed%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/plugins/jetpack/css/jetpack.css?ver=5.0' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-json/' />

 


<link rel='dns-prefetch' href='//v0.wordpress.com'>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<style type='text/css'>img#wpstats{display:none}</style>
<!-- Styles cached and displayed inline for speed. Generated by http://stylesplugin.com -->
<style type="text/css" id="styles-plugin-css">

</style>
</head>

<body class="archive tag tag-winapi tag-114 styles">

<div id="page" class="hfeed site container">

	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<!-- Get sidebar color option (Appearance -> Customize -> Theme Options) -->
		<header id="masthead" class="site-header dark" role="banner">
		<!-- Tab navigation -->
		<ul class="toggle-bar" role="tablist">
			<!-- Main navigation -->
			<li id="panel-1" class="current" role="presentation">
				<a href="#tab-1" role="tab" aria-controls="tab-1" aria-selected="true" class="current nav-toggle" data-tab="tab-1"><i class="fa fa-bars"></i><span class="screen-reader-text">View menu</span></a>
			</li>

			<!-- Featured Posts navigation -->
							<li id="panel-2" role="presentation">
					<a href="#tab-2" role="tab" aria-controls="tab-2" aria-selected="false" data-tab="tab-2"><i class="fa fa-thumb-tack"></i><span class="screen-reader-text">View featured posts</span></a>
				</li>
			
			<!-- Sidebar widgets navigation -->
			<li id="panel-3" role="presentation">
				<a href="#tab-3" role="tab" aria-controls="tab-3" aria-selected="false" class="folder-toggle" data-tab="tab-3"><i class="fa fa-folder"></i><i class="fa fa-folder-open"></i><span class="screen-reader-text">View sidebar</span></a>
			</li>
		</ul>

		<div id="tabs" class="toggle-tabs">
			<div class="site-header-inside">
				<!-- Logo, description and main navigation -->
				<div id="tab-1" class="tab-content current fadeIn">
					<div class="site-branding">
						<!-- Get the site branding -->
													<h1 class="site-title"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/" rel="home">Kevin Ragsdale</a></h1>
							<h2 class="site-description">FoxPro Programming and Visual FoxPro 9</h2>
											</div>

					<nav id="site-navigation" class="main-navigation" role="navigation">
						<div class="menu-nav-container"><ul id="menu-nav" class="menu"><li id="menu-item-1421" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1421"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/downloads-2/">Downloads</a></li>
<li id="menu-item-1417" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1417"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/visual-foxpro-books/">Visual FoxPro Books</a></li>
<li id="menu-item-2269" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2269"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/visual-foxpro-flls/">Visual FoxPro FLLs</a></li>
<li id="menu-item-1196" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1196"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/tips-and-tricks-to-improve-your-apps-ui/">It&#8217;s So, Uh, Gray</a></li>
</ul></div>					</nav><!-- #site-navigation -->

									</div><!-- #tab-1 -->

				<!-- Featured Posts template (template-featured-posts.php) -->
				
									<div id="tab-2" class="widget-area tab-content animated fadeIn">
						<div class="widget featured-posts-widget">
							<h2 class="widget-title">Multithreaded Visual FoxPro</h2>

							<div class="featured-posts">
							    
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/please-release-me/" rel="bookmark">Please RELEASE Me</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/please-release-me/" rel="bookmark"><time class="entry-date published" datetime="2012-07-24T07:51:37+00:00">July 24, 2012</time><time class="updated" datetime="2014-06-07T09:59:24+00:00">June 7, 2014</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/easy-multithreading-with-visual-foxpro/" rel="bookmark">Easy Multithreading with Visual FoxPro</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/easy-multithreading-with-visual-foxpro/" rel="bookmark"><time class="entry-date published" datetime="2012-07-14T07:09:03+00:00">July 14, 2012</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/shameless-self-promotion/" rel="bookmark">Shameless Self-Promotion</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/shameless-self-promotion/" rel="bookmark"><time class="entry-date published" datetime="2012-06-12T13:06:43+00:00">June 12, 2012</time><time class="updated" datetime="2015-06-06T08:36:56+00:00">June 6, 2015</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/christof-is-a-freaking-genius/" rel="bookmark">Christof Is A Freaking Genius</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/christof-is-a-freaking-genius/" rel="bookmark"><time class="entry-date published" datetime="2010-09-01T09:10:15+00:00">September 1, 2010</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																							</div><!-- .featured-posts -->
						</div><!-- .featured-posts-widget -->
					</div><!-- #tab-2 .widget-area -->
				
				<!-- Sidebar widgets -->
				<div id="tab-3" class="tab-content animated fadeIn" role="tabpanel" aria-labelledby="panel-3" aria-hidden="true">
						<div id="secondary" class="widget-area" role="complementary">
		<aside id="categories-2" class="widget widget_categories"><h2 class="widget-title">Categories</h2>		<ul>
	<li class="cat-item cat-item-2"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/books/" title="There are many great books about Visual FoxPro. My favorites are from Hentzenwerke Publishing. All of the titles from Hentzenwerke are well-written, concise, and provide excellent information. Highly recommended!">Books</a> (3)
</li>
	<li class="cat-item cat-item-3"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/conferences-blog/" >Conferences</a> (28)
</li>
	<li class="cat-item cat-item-4"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/desktop-alerts/" >Desktop Alerts</a> (9)
</li>
	<li class="cat-item cat-item-5"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/tips-and-tricks-to-improve-your-apps-ui/" title="Posts from my Southwest Fox 2011 session titled, &quot;It&#039;s so, uh, gray... Tips &amp; Tricks to Improve Your Apps Interface&quot;">It&#039;s So, Uh, Gray</a> (19)
</li>
	<li class="cat-item cat-item-6"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/multithreaded-visual-foxpro/" title="Posts related to my  Southwest Fox 2011 session titled, &quot;Easy Multithreading with Visual FoxPro&quot; (based on Christof Wollenhaupt&#039;s DMULT.DLL)">Multithreaded Visual FoxPro</a> (4)
</li>
	<li class="cat-item cat-item-135"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/personal/" >Personal</a> (9)
</li>
	<li class="cat-item cat-item-7"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/programming/" >Programming</a> (26)
</li>
	<li class="cat-item cat-item-8"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/screencasts/" title="Screencasts on a variety of topics related to Visual FoxPro programming">Screencasts</a> (5)
</li>
	<li class="cat-item cat-item-9"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/visual-fox-pro-user-groups/" >User Groups</a> (5)
</li>
	<li class="cat-item cat-item-141"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/visual-foxpro/" title="General items related to Visual FoxPro">Visual FoxPro</a> (15)
</li>
		</ul>
</aside><aside id="text-8" class="widget widget_text">			<div class="textwidget"><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-875609-8', 'auto');
  ga('send', 'pageview');

</script></div>
		</aside>	</div><!-- #secondary -->
				</div><!-- #tab-3 -->
			</div><!-- .site-header-inside -->
		</div><!-- #tabs -->
	</header><!-- #masthead -->

	<div id="content" class="site-content fadeInFast">

	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
			<header class="page-header">
				<h1 class="page-title">
					Tag / winapi				</h1>
							</header><!-- .page-header -->

			<!-- If author has a bio, show it. -->
			
						
				
<article id="post-913" class="post post-913 type-post status-publish format-standard hentry category-tips-and-tricks-to-improve-your-apps-ui tag-design tag-foxpro tag-programming-2 tag-visual-foxpro-2 tag-winapi tag-windows">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/windows-is-lying-to-you-with-dpi-virtualization/" rel="bookmark"><time class="entry-date published" datetime="2013-01-02T05:00:45+00:00">January 2, 2013</time><time class="updated" datetime="2014-06-15T08:22:58+00:00">June 15, 2014</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/windows-is-lying-to-you-with-dpi-virtualization/" rel="bookmark">Windows Is Lying To You&#8230; With DPI Virtualization</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
			<div class="entry-excerpt">
			<p>Windows lies, and Kevin cries, because his apps are blurry&#8230;</p>
		</div>
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a></li>
							<li class="meta-tag"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/design/" rel="tag">design</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/foxpro/" rel="tag">foxpro</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/programming-2/" rel="tag">programming</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/winapi/" rel="tag">winapi</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/windows/" rel="tag">windows</a></li>
							</ul>
</div>
	<div class="entry-content">
		<h1>DPI Virtualization in Windows</h1>
<p>Windows Vista (and subsequently, Windows 7 &amp; 8) introduced a new feature called <a title="MSDN explanation of DPI Virtualization" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd464660(v=vs.85).aspx#dpi_virtualization" target="_blank">DPI Virtualization</a>.</p>
<p>DPI Virtualization means Windows will automatically “resize” your forms and form objects for you, with no coding or resizing required on your part.</p>
<p>Sounds great, doesn&#8217;t it? Well, not quite. Remember my “ugly” <a title="Blurry form" href="http://kevinragsdale.info/wp-content/uploads/2012/12/Blurry.png" target="_blank">form</a> in an <a title="So, What Is An Ugly App Anyway?" href="" target="_blank">earlier post</a>, running at 144dpi? It was DPI Virtualized by Windows 7, and the result was a blurry window.</p>
<p>DPI Virtualization also requires the code listing from a <a title="Respecting The User’s Font Settings" href="" target="_blank">previous post</a> to fail, every time. Why? Because when the code asks Windows, “Hey, what’s the current setting?”, Windows Vista, 7 and 8 will always answer “your font factor is 1” (no resizing required) <em>if the user has selected to use DPI Virtualization</em>.</p>
<p>“Whoa, whoa, whoa, Kevin! <em><strong>If</strong> the user has selected DPI Virtualization</em>?”</p>
<p>Yes. Windows Vista, 7 and 8 have two different modes of DPI scaling: XP Style, and DPI Virtualization.</p>
<div id="attachment_914" style="width: 404px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Unchecked.png"><img class="size-full wp-image-914" alt="Setting the DPI scale mode in Windows 7" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Unchecked.png?resize=394%2C283" srcset="https://i1.wp.com//wp-content/uploads/2013/01/Unchecked.png?w=394&amp;ssl=1 394w, https://i1.wp.com//wp-content/uploads/2013/01/Unchecked.png?resize=300%2C215&amp;ssl=1 300w" sizes="(max-width: 394px) 100vw, 394px" data-recalc-dims="1" /></a><p class="wp-caption-text">Setting the DPI scale mode in Windows 7</p></div>
<p>If the user changes her DPI setting, and checks the “Use Windows XP style DPI scaling” checkbox, Windows Vista, 7 and 8 will return the expected (truthful) result from the previous code listing – just like XP did.</p>
<p>So, a DPI of 144dpi (150%) with this box unchecked, results in the following:</p>
<div id="attachment_915" style="width: 340px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/XPStyle.png"><img class="size-full wp-image-915" alt="The correct font factor with XP style scaling turned on" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/XPStyle.png?resize=330%2C249" srcset="https://i0.wp.com//wp-content/uploads/2013/01/XPStyle.png?w=330&amp;ssl=1 330w, https://i0.wp.com//wp-content/uploads/2013/01/XPStyle.png?resize=300%2C226&amp;ssl=1 300w" sizes="(max-width: 330px) 100vw, 330px" data-recalc-dims="1" /></a><p class="wp-caption-text">The correct font factor with XP style scaling turned on</p></div>
<p>And, just like I would do with the XP result from earlier, I would want to resize my forms and form objects, making them 50% larger than “normal.”</p>
<p>But if the user has not checked the box, here’s what Windows tells me about the “font factor” (notice the messagebox is also a bit blurry):</p>
<div id="attachment_916" style="width: 394px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Blurry2.png"><img class="size-full wp-image-916" alt="Thanks, Windows, for lying and making my forms blurry" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Blurry2.png?resize=384%2C301" srcset="https://i2.wp.com//wp-content/uploads/2013/01/Blurry2.png?w=384&amp;ssl=1 384w, https://i2.wp.com//wp-content/uploads/2013/01/Blurry2.png?resize=300%2C235&amp;ssl=1 300w" sizes="(max-width: 384px) 100vw, 384px" data-recalc-dims="1" /></a><p class="wp-caption-text">Thanks, Windows, for lying to me and making my forms blurry</p></div>
<p>Great. The user has selected 144dpi, but my app does not know this because Windows has said, “Don’t worry, no need to resize anything. All is good.”</p>
<p>And my user gets to see “somewhat” resized, yet blurry, forms in my app.</p>
<p>What we need is a “Windows Lie Detector” to make sure Windows stops lying to us.</p>
<p>How do we do this?</p>
<p>We need to tell Windows that the app is “DPI Aware”.</p>
<p>And that&#8217;s exactly what we&#8217;ll look at in tomorrow&#8217;s post.</p>
<p>&nbsp;</p>
<h3>Related Links (With much better explanations)</h3>
<p><a title="A much better explanation" href="http://www.kynosarges.org/WindowsDpi.html" target="_blank">High DPI Settings In Windows<br />
</a><a title="Fixing Windows Programming" href="http://news.kynosarges.org/2012/07/10/fixing-windows-programming/" target="_blank">Fixing Windows Programming</a></p>
<p>&nbsp;</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-280" class="post post-280 type-post status-publish format-standard hentry category-desktop-alerts tag-desktop-alerts-2 tag-memory tag-winapi">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/from-a-hog-to-just-a-pig-with-a-simple-windows-api-call/" rel="bookmark"><time class="entry-date published" datetime="2009-07-26T19:50:51+00:00">July 26, 2009</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/from-a-hog-to-just-a-pig-with-a-simple-windows-api-call/" rel="bookmark">From A Hog To Just A Pig With A Simple Windows API Call</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
			<div class="entry-excerpt">
			<p>Reducing memory consumption of your Visual FoxPro apps is easily done with a couple of Windows API calls, thanks to Sergey.</p>
		</div>
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/desktop-alerts/" rel="category tag">Desktop Alerts</a></li>
							<li class="meta-tag"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/desktop-alerts-2/" rel="tag">desktop alerts</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/memory/" rel="tag">memory</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/winapi/" rel="tag">winapi</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p>One of the first questions I got about the <a title="Desktop Alerts Blog Category" href="" target="_blank">Desktop Alerts</a> was, &#8220;How much memory and other system resources does this use?&#8221;</p>
<p>This was during the presentation in Chicago in December of 2006. My response was the typical, &#8220;Oh, not much at all. It’s very light.&#8221;</p>
<p>Well, I fired up Task Manager (in front of everyone in the room), and was shocked to find this tiny little app using 10MB of memory &#8212; <em>even when it was just sitting there, doing nothing</em>!</p>
<p>&#8220;Hmmm,&#8221; I thought, &#8220;This thing is a hog.&#8221;</p>
<p>Not a <em>huge</em> issue, especially compared to a <a title="Catastrophic Failure and Desktop Alerts" href="" target="_blank">Catastrophic Failure</a>, so I put it on the backburner (which is to say I promptly forgot all about it &#8212; if only my apps could free up memory as easily as my brain does).</p>
<p>I recently worked on an app that uses the Microsoft Web Browser control on a Visual FoxPro form as the primary UI for the app. Works well for the most part, but checking memory usage in Task Manager showed a tremendous amount of resources being hogged by the app, even when the user is just sitting there looking at the screen and doing nothing.</p>
<p>&#8220;Hmmm,&#8221; I thought, &#8220;<em>this </em>thing is a hog, too.&#8221;</p>
<p>(I started looking at the app’s memory usage after a couple of users with &#8220;programming experience&#8221; mentioned it…)</p>
<p>Luckily for me, in January of this year <a title="Sergey's Blog" href="http://www.berezniker.com/" target="_blank">Sergey Berezniker</a> wrote about using the Windows API to <a title="Blog post: Lowering memory usage by application" href="http://www.berezniker.com/content/pages/visual-foxpro/lowering-memory-usage-application" target="_blank">lower the memory usage of your application</a>.</p>
<p>Simple, straightforward, and very simple to implement.</p>
<p>I put it in the app, and was amazed by how much memory was saved by a simple function call. I went from about 60MB at application startup to about 8MB.</p>
<p>After 6 months in production, I’ve seen no problems reported about the app that would indicate a problem with this function, so yesterday I decided to look at adding it to the Desktop Alerts.</p>
<p>Here’s a quick sampling of the results (Windows XP Professional Service Pack 3):</p>
<p><strong>1. AlertManager Initialized, waiting for something to do:</strong></p>
<table border="0" cellspacing="3" cellpadding="5">
<tbody>
<tr>
<td valign="top" width="200"><strong>Before Change (Hog)</strong></td>
<td valign="top" width="200"><strong>After Change (Pig)</strong></td>
</tr>
<tr>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-388" title="noalerts" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/noalerts.png?resize=300%2C59" alt="" srcset="https://i2.wp.com//wp-content/uploads/2012/06/noalerts.png?w=359&amp;ssl=1 359w, https://i2.wp.com//wp-content/uploads/2012/06/noalerts.png?resize=300%2C59&amp;ssl=1 300w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-392" title="noalerts2" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/noalerts2.png?resize=300%2C57" alt="" srcset="https://i1.wp.com//wp-content/uploads/2012/06/noalerts2.png?w=362&amp;ssl=1 362w, https://i1.wp.com//wp-content/uploads/2012/06/noalerts2.png?resize=300%2C57&amp;ssl=1 300w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
</tr>
</tbody>
</table>
<p><strong>2. First Alert created and visible:</strong></p>
<table border="0" cellspacing="3" cellpadding="5">
<tbody>
<tr>
<td valign="top" width="200"><strong>Before Change (Hog)</strong></td>
<td valign="top" width="200"><strong>After Change (Pig)</strong></td>
</tr>
<tr>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-354" title="1stalert" src="https://i2.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/1stalert.png?resize=300%2C57" alt="" srcset="https://i1.wp.com//wp-content/uploads/2012/06/1stalert.png?zoom=2&amp;resize=300%2C57&amp;ssl=1 600w, https://i1.wp.com//wp-content/uploads/2012/06/1stalert.png?zoom=3&amp;resize=300%2C57&amp;ssl=1 900w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-356" title="1stalert2" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/1stalert2.png?resize=300%2C57" alt="" srcset="https://i2.wp.com//wp-content/uploads/2012/06/1stalert2.png?zoom=2&amp;resize=300%2C57&amp;ssl=1 600w, https://i2.wp.com//wp-content/uploads/2012/06/1stalert2.png?zoom=3&amp;resize=300%2C57&amp;ssl=1 900w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
</tr>
</tbody>
</table>
<p><strong>3. Three alerts visible on screen:</strong></p>
<table border="0" cellspacing="3" cellpadding="5">
<tbody>
<tr>
<td valign="top" width="200"><strong>Before Change (Hog)</strong></td>
<td valign="top" width="200"><strong>After Change (Pig)</strong></td>
</tr>
<tr>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-358" title="3alerts" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/3alerts.png?resize=300%2C57" alt="" srcset="https://i1.wp.com//wp-content/uploads/2012/06/3alerts.png?zoom=2&amp;resize=300%2C57&amp;ssl=1 600w, https://i1.wp.com//wp-content/uploads/2012/06/3alerts.png?zoom=3&amp;resize=300%2C57&amp;ssl=1 900w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-360" title="3alerts2" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/3alerts2.png?resize=300%2C55" alt="" srcset="https://i0.wp.com//wp-content/uploads/2012/06/3alerts2.png?zoom=2&amp;resize=300%2C55&amp;ssl=1 600w, https://i0.wp.com//wp-content/uploads/2012/06/3alerts2.png?zoom=3&amp;resize=300%2C55&amp;ssl=1 900w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
</tr>
</tbody>
</table>
<p><strong>4. All alerts cleared, AlertManager waiting for next command:</strong></p>
<table border="0" cellspacing="3" cellpadding="5">
<tbody>
<tr>
<td valign="top" width="200"><strong>Before Change (Hog)</strong></td>
<td valign="top" width="200"><strong>After Change (Pig)</strong></td>
</tr>
<tr>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-389" title="noalerts_1" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/noalerts_1.png?resize=300%2C59" alt="" srcset="https://i1.wp.com//wp-content/uploads/2012/06/noalerts_1.png?w=359&amp;ssl=1 359w, https://i1.wp.com//wp-content/uploads/2012/06/noalerts_1.png?resize=300%2C59&amp;ssl=1 300w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
<td valign="top" width="200"><a href=""><img class="alignnone  wp-image-393" title="noalerts2_1" src="https://i2.wp.com/kevinragsdale.info/wp-content/uploads/2012/06/noalerts2_1.png?resize=300%2C57" alt="" srcset="https://i0.wp.com//wp-content/uploads/2012/06/noalerts2_1.png?w=362&amp;ssl=1 362w, https://i0.wp.com//wp-content/uploads/2012/06/noalerts2_1.png?resize=300%2C57&amp;ssl=1 300w" sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1" /></a></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>So, with <a title="EmptyWorkingSet function" href="http://msdn.microsoft.com/en-us/library/ms682606(VS.85).aspx" target="_blank">one simple Windows API call</a>, we’ve reduced the memory usage by almost 80%, turning this gigantic hog into a smaller pig. I’ve seen similar results in Vista, though the memory usage in Vista was much lower to start with than in XP, so the results of the change aren’t quite as dramatic.</p>
<p>One interesting thing, though. See the User Name column in the screenshots? The user changed from <strong>Kevin Ragsdale</strong> to <strong>SYSTEM</strong>. So, not only has a hog become a pig, its name has been changed as well. In Windows Vista, the User Name stays put as Kevin Ragsdale.</p>
<blockquote><p><em>Anyone that can explain this to me without causing my head to explode &#8212; feel free to explain in the comments.</em></p></blockquote>
<p>This API function is available in Windows 2000 and higher so, if you have any <a title="When Do You Say Your App Is “Not Supported”?" href="" target="_blank">OS stragglers</a> you’ll want to bracket the function call with something like this:</p>
<pre>IF VAL(OS(3)) &gt;= 5    &amp;&amp; Skip if earlier than Windows 2000
   ** Do your thing
ENDIF</pre>
<p>And yes, I <em>do</em> have a ton of code &#8220;out there&#8221; that uses this bracket a lot…</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-278" class="post post-278 type-post status-publish format-standard hentry category-programming tag-winapi tag-windows-api">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/dont-be-so-hard-on-yourself-or-shellexecute-to-the-rescue/" rel="bookmark"><time class="entry-date published" datetime="2009-07-21T13:53:10+00:00">July 21, 2009</time><time class="updated" datetime="2015-04-19T10:34:25+00:00">April 19, 2015</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/dont-be-so-hard-on-yourself-or-shellexecute-to-the-rescue/" rel="bookmark">Don’t Be So Hard On Yourself (or, ShellExecute() to the Rescue!)</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/programming/" rel="category tag">Programming</a></li>
							<li class="meta-tag"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/winapi/" rel="tag">winapi</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/windows-api/" rel="tag">windows api</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p>I’ve got a bad habit of always trying to reinvent the wheel, even when I’ve got a perfectly good wheel right in front of me.</p>
<p>I just wrapped up some work on a <a href="http://msdn.microsoft.com/vfoxpro" target="_blank">Visual FoxPro</a> app that uses a lot of rich-text format (RTF) files, and I was hitting a brick wall when it came to printing the documents.</p>
<p>I tried the <a href="http://fox.wikis.com/" target="_blank">FoxWiki</a>, <a href="http://www.google.com/" target="_blank">Google</a> searches, even went back to my <a href="http://www.hentzenwerke.com/catalog/kilofox.htm" target="_blank">KiloFox</a> book (excerpt <a href="http://books.google.com/books?id=wKNfTHRNkLAC&amp;pg=PA545&amp;lpg=PA545&amp;dq=rich-text+foxpro&amp;source=bl&amp;ots=_Z8-iQQj3E&amp;sig=2fLHB3UCljJc_0bLBEnNEbh9HvY&amp;hl=en&amp;ei=_gVmSraRGaOBtweZl-UB&amp;sa=X&amp;oi=book_result&amp;ct=result&amp;resnum=6" target="_blank">here</a>), but I just couldn’t find the right method to make the program do what I wanted it to do.</p>
<p>Then I thought, &#8220;Hmmm… every Windows computer has an <a title="WordPad" href="http://windowshelp.microsoft.com/windows/en-us/help/9f990a06-474a-42ab-8942-3917cd5d5ffe1033.mspx" target="_blank">RTF editor</a>, right? And this editor has all the <a title="Printing Your Document in WordPad" href="http://windowshelp.microsoft.com/windows/en-us/help/9f990a06-474a-42ab-8942-3917cd5d5ffe1033.mspx#section_8" target="_blank">print functionality</a> built-in. <strong><em>Very interesting…</em></strong>&#8221;</p>
<p>Plus, if the user has word-processing software (Office, OpenOffice, etc.) and it’s properly registered as the handler for RTF files, it’ll have all the print functionality built-in, too.</p>
<p>So, instead of pulling out the remaining few hairs on my head, I decided to go the <a title="ShellExecute() Documentation on MSDN" href="http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx" target="_blank">ShellExecute()</a> route, and set the menu up to open the user’s default RTF application in two different ways:</p>
<ul>
<li>EDIT mode &#8211;  (The Print menu item &#8211; the user can do what they want with the document, then select the printer, etc.)</li>
<li>PRINT mode (The Quick Print menu item &#8211; open the app, and print the document to the default Windows printer)</li>
</ul>
<div><img class="alignnone wp-image-396 size-full" title="Firing ShellExecute() from the print menu" src="https://i2.wp.com//wp-content/uploads/2012/06/print.png?resize=596%2C314" alt="Print menu example" srcset="https://i2.wp.com//wp-content/uploads/2012/06/print.png?w=596&amp;ssl=1 596w, https://i2.wp.com//wp-content/uploads/2012/06/print.png?resize=300%2C158&amp;ssl=1 300w" sizes="(max-width: 596px) 100vw, 596px" data-recalc-dims="1" /></div>
<p>&nbsp;</p>
<p>So, I went from researching and trying all kinds of workarounds to this:</p>
<pre><strong>ShellExecute(FindWindow(0,_SCREEN.Caption),"Open",lcTempFile,"",JUSTPATH(lcTempFile),1</strong><strong>)</strong></pre>
<p>and</p>
<pre><strong>ShellExecute(FindWindow(0,_SCREEN.Caption),"Print",lcTempFile,"",JUSTPATH(lcTempFile),1</strong><strong>)</strong></pre>
<p>And immediately felt relieved for being just a little less hard on myself…</p>
<p>On a side note, the app uses the <a title="CommandBars Library Home Page" href="http://www.arg.kirov.ru/products/cmdbars/" target="_blank">CommandBars</a> Library from <a title="ARG-Software Design Lab Home Page" href="http://www.arg.kirov.ru/" target="_blank">Alex Grigorjev</a>. I was lucky enough to still have an active subscription when he released Version 7.0 (which includes the Ribbon interface).</p>
<p><strong>VERY HIGHLY RECOMMENDED!!!</strong></p>
<p>More info on the CommandBars library:</p>
<ul>
<li>The <a href="http://thefoxshow.com/" target="_blank">FoxShow</a> (Episode #8: <a href="http://akselsoft.libsyn.com/index.php?post_id=6168">VFP Letter, Interfaces, CommandBars and Variables</a>)</li>
<li><a href="http://www.aksel.com/screencasts/commandbars.html" target="_blank">Screencast</a> on using the library from from <a href="http://akselsoft.blogspot.com/" target="_blank">Andrew MacNeill</a></li>
</ul>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-83" class="post post-83 type-post status-publish format-standard hentry category-desktop-alerts tag-forms tag-visual-foxpro-2 tag-winapi">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/creating-a-fading-form/" rel="bookmark"><time class="entry-date published" datetime="2005-03-24T15:32:08+00:00">March 24, 2005</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/creating-a-fading-form/" rel="bookmark">Creating a &#8220;Fading&#8221; Form</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/category/desktop-alerts/" rel="category tag">Desktop Alerts</a></li>
							<li class="meta-tag"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/forms/" rel="tag">forms</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/tag/winapi/" rel="tag">winapi</a></li>
						<li class="meta-comment">
			<span class="comments-link"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/creating-a-fading-form/#comments"><span class="dsq-postid" data-dsqidentifier="83 http:///?p=83">1 Comment</span></a></span>
		</li>
					</ul>
</div>
	<div class="entry-content">
		<p>I love the Desktop Alerts in Outlook 2003. They provide useful information <em>without interfering </em>with my work. I can&#8217;t stand to be working on one thing and suddenly have a MESSAGEBOX appear from another app informing me that it just did something wonderful on my behalf. The Desktop Alerts simply “appear” on my screen for a few seconds, letting me know I have new mail. They even provide some details (name of sender, subject). If I want to read the email immediately, I simply click on the Alert and Outlook opens the message. Otherwise, I can ignore the alert and it will fade away.</p>
<p>I thought something like this would be a great enhancement for some of my clients, so I went about the task of finding out how to make my forms Fade-In, Wait a Few Seconds for User Input, and Fade-Out. I found a solution right away in the Solution Samples that ship with VFP: Transparent Forms.</p>
<p>A couple of Windows API calls can make your form transparent, to the level of transparency you require. The trick to making my form fade-in and out was to add a couple of timer controls to the form. The timers call the SetLayeredWindowAttributes function in a FOR loop, creating the fade-in/fade-out effect.</p>
<p>I put together a simple “splash” screen (you can download it <a href="">here</a>), which demonstrates the effect. The zip file contains three files: FLASHSPLASH.SCX, FLASHSPLASH.SCT, and 192255.JPG (a gradient JPG that you can set as the form&#8217;s picture if you want to).</p>
<p>Two caveats: to create the effects, the user must be running Windows 2000 or higher, and the effects only work on Top-Level forms.</p>
<p>The form contains a few custom properties:</p>
<ul>
<li><strong>lCanFlash</strong>: A boolean value (.T. if Windows 2000 or higher, otherwise .F.)</li>
<li><strong>nStepUp</strong>: An integer which determines how quickly the form will appear (used by the STEP clause in the first timer&#8217;s FOR loop). The higher the number, the faster the form fades-in. Defaults to 0.25</li>
<li><strong>nStepDown</strong>: An integer which determines how quickly the form will disappear (used by the STEP clause in the second timer&#8217;s FOR loop). This number must be less than zero! Defaults to -0.25</li>
<li><strong>nTransparency</strong>: An integer which determines the level of transparency for the form. A value of 25 is a “solid“ form. A value of zero (0) makes the form completely transaparent.</li>
</ul>
<p>The lCanFlash property has an assign method, which basically DECLAREs the API functions and sets the form as completely transparent (if Windows 2000 or higher). The lCanFlash property is set in the form&#8217;s Init() method.</p>
<p>In a nutshell, here&#8217;s what the sample form does:</p>
<ol>
<li>Checks to see if the OS is Win2K or higher. If yes,
<ol>
<li>Sets the lCanFlash property to .T., which in turn,</li>
<li>DECLAREs the API Functions</li>
<li>Calls the API Functions to make the form completely transparent (invisible)</li>
</ol>
</li>
<li>Turns on the first timer, which uses the form&#8217;s custom properties to drive a FOR loop, which calls the SetLayeredWindowAttributes API function &#8212; causing the form to gradually appear</li>
<li>Since the sample form is a splash screen, another little FOR loop updates a label control, to make the form look like it&#8217;s “doing“ something</li>
<li>Turns on the second timer, which also uses the form&#8217;s custom properties to drive a FOR loop, which makes the form gradually disappear</li>
<li>The second timer then Releases the form. The form&#8217;s Destroy method issues a CLEAR DLLS command</li>
</ol>
<p>I have an app which periodically checks a server to see if any of my user&#8217;s customer&#8217;s have placed orders. If orders are found, they are downloaded for processing, but it&#8217;s all done in the background. The user&#8217;s typically have no idea an order has been placed unless they stop what they&#8217;re doing to either go to a website which shows outstanding orders, or by launching the interactive app.  By adding my own “desktop alerts“ to the system, I can give the user a professional-looking piece of information which shouldn&#8217;t interfere with their work.</p>
<p>Hope you like it. Since this is my first attempt to share something with the FoxPro community, <em>any</em> feedback would be greatly appreciated. Once I get done with my “desktop alert“ system, I&#8217;ll pass it along.</p>
<p><a title="Zipped file (5 kb)" href="">Sample Form Download</a></p>
<p>Edited: Probably best to try this out in VFP 7,8 or 9. It&#8217;s been so long since I&#8217;ve actually “used“ VFP 6, I forgot about the hoops you&#8217;ll have to jump through to make this work (like HWND). Thanks Fred for your feedback! &#8211; Kevin</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
			
		
		</main><!-- #main -->
	</section><!-- #primary -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
			<a class="powered-by" href="http://wordpress.org/">Proudly powered by WordPress</a>
			<span class="sep"> | </span>
			Theme: editor by <a href="https://array.is/">Array</a>		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	<div style="display:none">
	</div>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/plugins/jetpack/modules/photon/photon.js?ver=20130122'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201725'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2017Junaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.8'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/themes/editor/js/jquery.fitvids.js?ver=20140820'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/themes/editor/js/editor.js?ver=20120206'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-includes/js/wp-embed.min.js?ver=4.8'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"kevinragsdale"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/tag/winapi/kevinragsdale.github.io/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.8'></script>
<script type='text/javascript' src='https://stats.wp.com/e-201725.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:5.0',blog:'34471053',post:'0',tz:'-5',srv:''} ]);
	_stq.push([ 'clickTrackerInit', '34471053', '0' ]);
</script>

</body>
</html>
