<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<base href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io" />

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Is Your App DPI-Aware?</title>

<!-- This site is optimized with the Yoast SEO plugin v4.9 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Tell Windows that your app is DPI-aware, and Windows will no longer lie to you."/>
<link rel="canonical" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/is-your-app-dpi-aware/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Is Your App DPI-Aware?" />
<meta property="og:description" content="Tell Windows that your app is DPI-aware, and Windows will no longer lie to you." />
<meta property="og:url" content="kevinragsdale.github.io/is-your-app-dpi-aware/" />
<meta property="og:site_name" content="Kevin Ragsdale" />
<meta property="article:tag" content="design" />
<meta property="article:tag" content="dpi virtualization" />
<meta property="article:tag" content="foxpro" />
<meta property="article:tag" content="SetProcessDPIAware()" />
<meta property="article:tag" content="visual foxpro" />
<meta property="article:tag" content="windows" />
<meta property="article:section" content="It&#039;s So, Uh, Gray" />
<meta property="article:published_time" content="2013-01-03T05:00:25-05:00" />
<meta property="article:modified_time" content="2015-06-06T08:51:02-05:00" />
<meta property="og:updated_time" content="2015-06-06T08:51:02-05:00" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />


		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='editor-style-css'  href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/themes/editor/style.css?ver=4.8' type='text/css' media='all' />
<link rel='stylesheet' id='editor-font-awesome-css-css'  href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/themes/editor/inc/fontawesome/font-awesome.css?ver=4.1.0' type='text/css' media='screen' />
<!--[if IE]>
<link rel='stylesheet' id='ie7-style-css'  href='kevinragsdale.github.io/wp-content/themes/editor/inc/styles/ie.css?ver=4.8' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='editor-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C600%2C700%2C400italic%2C600italic%2C700italic%7CRoboto+Condensed%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/plugins/jetpack/css/jetpack.css?ver=5.0' type='text/css' media='all' />
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-json/' />

 

<link rel='shortlink' href='https://wp.me/p2kDuJ-eV' />



<link rel='dns-prefetch' href='//v0.wordpress.com'>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/is-your-app-dpi-aware/amp/" />
<!-- Styles cached and displayed inline for speed. Generated by http://stylesplugin.com -->
<style type="text/css" id="styles-plugin-css">

</style>
</head>

<body class="post-template-default single single-post postid-925 single-format-standard styles">

<div id="page" class="hfeed site container">

	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<!-- Get sidebar color option (Appearance -> Customize -> Theme Options) -->
		<header id="masthead" class="site-header dark" role="banner">
		<!-- Tab navigation -->
		<ul class="toggle-bar" role="tablist">
			<!-- Main navigation -->
			<li id="panel-1" class="current" role="presentation">
				<a href="#tab-1" role="tab" aria-controls="tab-1" aria-selected="true" class="current nav-toggle" data-tab="tab-1"><i class="fa fa-bars"></i><span class="screen-reader-text">View menu</span></a>
			</li>

			<!-- Featured Posts navigation -->
							<li id="panel-2" role="presentation">
					<a href="#tab-2" role="tab" aria-controls="tab-2" aria-selected="false" data-tab="tab-2"><i class="fa fa-thumb-tack"></i><span class="screen-reader-text">View featured posts</span></a>
				</li>
			
			<!-- Sidebar widgets navigation -->
			<li id="panel-3" role="presentation">
				<a href="#tab-3" role="tab" aria-controls="tab-3" aria-selected="false" class="folder-toggle" data-tab="tab-3"><i class="fa fa-folder"></i><i class="fa fa-folder-open"></i><span class="screen-reader-text">View sidebar</span></a>
			</li>
		</ul>

		<div id="tabs" class="toggle-tabs">
			<div class="site-header-inside">
				<!-- Logo, description and main navigation -->
				<div id="tab-1" class="tab-content current fadeIn">
					<div class="site-branding">
						<!-- Get the site branding -->
													<h1 class="site-title"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/" rel="home">Kevin Ragsdale</a></h1>
							<h2 class="site-description">FoxPro Programming and Visual FoxPro 9</h2>
											</div>

					<nav id="site-navigation" class="main-navigation" role="navigation">
						<div class="menu-nav-container"><ul id="menu-nav" class="menu"><li id="menu-item-1421" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1421"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/downloads-2/">Downloads</a></li>
<li id="menu-item-1417" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1417"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/visual-foxpro-books/">Visual FoxPro Books</a></li>
<li id="menu-item-2269" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2269"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/visual-foxpro-flls/">Visual FoxPro FLLs</a></li>
<li id="menu-item-1196" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1196"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/tips-and-tricks-to-improve-your-apps-ui/">It&#8217;s So, Uh, Gray</a></li>
</ul></div>					</nav><!-- #site-navigation -->

									</div><!-- #tab-1 -->

				<!-- Featured Posts template (template-featured-posts.php) -->
				
									<div id="tab-2" class="widget-area tab-content animated fadeIn">
						<div class="widget featured-posts-widget">
							<h2 class="widget-title">Multithreaded Visual FoxPro</h2>

							<div class="featured-posts">
							    
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/please-release-me/" rel="bookmark">Please RELEASE Me</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/please-release-me/" rel="bookmark"><time class="entry-date published" datetime="2012-07-24T07:51:37+00:00">July 24, 2012</time><time class="updated" datetime="2014-06-07T09:59:24+00:00">June 7, 2014</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/easy-multithreading-with-visual-foxpro/" rel="bookmark">Easy Multithreading with Visual FoxPro</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/easy-multithreading-with-visual-foxpro/" rel="bookmark"><time class="entry-date published" datetime="2012-07-14T07:09:03+00:00">July 14, 2012</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/shameless-self-promotion/" rel="bookmark">Shameless Self-Promotion</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/shameless-self-promotion/" rel="bookmark"><time class="entry-date published" datetime="2012-06-12T13:06:43+00:00">June 12, 2012</time><time class="updated" datetime="2015-06-06T08:36:56+00:00">June 6, 2015</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/christof-is-a-freaking-genius/" rel="bookmark">Christof Is A Freaking Genius</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/christof-is-a-freaking-genius/" rel="bookmark"><time class="entry-date published" datetime="2010-09-01T09:10:15+00:00">September 1, 2010</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																							</div><!-- .featured-posts -->
						</div><!-- .featured-posts-widget -->
					</div><!-- #tab-2 .widget-area -->
				
				<!-- Sidebar widgets -->
				<div id="tab-3" class="tab-content animated fadeIn" role="tabpanel" aria-labelledby="panel-3" aria-hidden="true">
						<div id="secondary" class="widget-area" role="complementary">
		<aside id="categories-2" class="widget widget_categories"><h2 class="widget-title">Categories</h2>		<ul>
	<li class="cat-item cat-item-2"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/books/" title="There are many great books about Visual FoxPro. My favorites are from Hentzenwerke Publishing. All of the titles from Hentzenwerke are well-written, concise, and provide excellent information. Highly recommended!">Books</a> (3)
</li>
	<li class="cat-item cat-item-3"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/conferences-blog/" >Conferences</a> (28)
</li>
	<li class="cat-item cat-item-4"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/desktop-alerts/" >Desktop Alerts</a> (9)
</li>
	<li class="cat-item cat-item-5"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/tips-and-tricks-to-improve-your-apps-ui/" title="Posts from my Southwest Fox 2011 session titled, &quot;It&#039;s so, uh, gray... Tips &amp; Tricks to Improve Your Apps Interface&quot;">It&#039;s So, Uh, Gray</a> (19)
</li>
	<li class="cat-item cat-item-6"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/multithreaded-visual-foxpro/" title="Posts related to my  Southwest Fox 2011 session titled, &quot;Easy Multithreading with Visual FoxPro&quot; (based on Christof Wollenhaupt&#039;s DMULT.DLL)">Multithreaded Visual FoxPro</a> (4)
</li>
	<li class="cat-item cat-item-135"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/personal/" >Personal</a> (9)
</li>
	<li class="cat-item cat-item-7"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/programming/" >Programming</a> (26)
</li>
	<li class="cat-item cat-item-8"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/screencasts/" title="Screencasts on a variety of topics related to Visual FoxPro programming">Screencasts</a> (5)
</li>
	<li class="cat-item cat-item-9"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/visual-fox-pro-user-groups/" >User Groups</a> (5)
</li>
	<li class="cat-item cat-item-141"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/visual-foxpro/" title="General items related to Visual FoxPro">Visual FoxPro</a> (15)
</li>
		</ul>
</aside><aside id="text-8" class="widget widget_text">			<div class="textwidget"><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-875609-8', 'auto');
  ga('send', 'pageview');

</script></div>
		</aside>	</div><!-- #secondary -->
				</div><!-- #tab-3 -->
			</div><!-- .site-header-inside -->
		</div><!-- #tabs -->
	</header><!-- #masthead -->

	<div id="content" class="site-content fadeInFast">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-925" class="post post-925 type-post status-publish format-standard hentry category-tips-and-tricks-to-improve-your-apps-ui tag-design tag-dpi-virtualization tag-foxpro tag-setprocessdpiaware tag-visual-foxpro-2 tag-windows">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/is-your-app-dpi-aware/" rel="bookmark"><time class="entry-date published" datetime="2013-01-03T05:00:25+00:00">January 3, 2013</time><time class="updated" datetime="2015-06-06T08:51:02+00:00">June 6, 2015</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title">Is Your App DPI-Aware?</h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a></li>
							<li class="meta-tag"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/tag/design/" rel="tag">design</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/tag/dpi-virtualization/" rel="tag">dpi virtualization</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/tag/foxpro/" rel="tag">foxpro</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/tag/setprocessdpiaware/" rel="tag">SetProcessDPIAware()</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/tag/windows/" rel="tag">windows</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p>When you tell Windows Vista (and 7 &amp; 8) that your app is DPI-aware, Windows will not use DPI virtualization for your app and will no longer “lie” when you ask about the DPI settings.</p>
<p>Please note that by telling Windows that your app is DPI-aware, it is completely up to your app (you) to resize your UI in order to match user expectations based on their settings.</p>
<p>There are 2 different ways to tell Windows Vista, 7 and 8 that your app is DPI-aware:</p>
<ul>
<li>a Windows API function, or</li>
<li>adding a section to your apps manifest file.</li>
</ul>
<h3></h3>
<h3>Using a Windows API Function</h3>
<p>Windows Vista, 7 and 8 contain an API function named SetProcessDPIAware. The function has no parameters. It returns a zero if the function fails, and a non-zero result if the function succeeds.</p>
<p>Using it from within Visual FoxPro is easy:</p>
<pre>DECLARE INTEGER SetProcessDPIAware IN WIN32API
SetProcessDPIAware()</pre>
<p>The function simply tells Windows, “This app (process) is DPI Aware, so please do not lie to me. I will handle all of the resizing myself, so my users will see things the way they want to.”</p>
<p>Easy, right? Well, kind of. If you run the code listing above from the VFP Command Window, and if your Windows DPI setting has been set to 144dpi with DPI Virtualization turned on, you’ll get the correct (truthful) font factor from Windows (when you follow the API call with the code listing from a <a title="Respecting The User’s Font Settings" href="" target="_blank">previous post</a>).</p>
<p>BUT, remember this function has told Windows that this <em>process</em> is DPI-aware. And since you’re running the code from within the VFP IDE, you&#8217;re essentially telling Windows that <em>Visual FoxPro</em> is DPI-aware.</p>
<p>Unfortunately, Visual FoxPro is not DPI-aware, and has already been “DPI virtualized” by Windows. Causing Windows to suddenly accept that Visual FoxPro is DPI-aware can wreak havoc with the IDE.</p>
<p>If you don’t trust me on this, try it. It&#8217;s u-g-l-y!</p>
<p>So, one way we can force Windows to accept the fact that our app is DPI-aware is to simply call the SetProcessDPIAware function – preferably as early in your app as possible. I have seen several forum postings which report calling the function too late can cause Windows to continue to “lie” and use DPI virtualization anyway, though I have not recreated this problem myself.</p>
<p>&nbsp;</p>
<h3>Using Your App Manifest File</h3>
<p>Another way to tell Windows Vista (and 7) that the app is DPI-aware is to add the following section to your app manifest file:</p>
<pre>
&lt;asmv3:application xmlns:asmv3="urn:schemas-microsoft-com:asm.v3"&gt;
   &lt;asmv3:windowsSettings xmlns="http://schemas.microsoft.com/SMI/2005/WindowsSettings"&gt;
      &lt;dpiAware&gt;true&lt;/dpiAware&gt;
   &lt;/asmv3:windowsSettings&gt;
&lt;/asmv3:application&gt;
</pre>
<p>If you are not sure about manifest files and adding manifest resources to your Visual FoxPro applications, I recommend the following articles (I&#8217;ve been using Markus&#8217; Manifest Tools in my work):</p>
<p><a href="http://blogs.msdn.com/b/calvin_hsia/archive/2007/04/13/add-a-manifest-to-control-your-application-vista-uac-behavior.aspx" target="_blank">Calvin Hsia: Add a Manifest to Control Your Application Vista UAC Behavior</a></p>
<p><a href="https://web.archive.org/web/20150415195306/http://www.sweetpotatosoftware.com/spsblog/2009/08/03/ApplyApplicationManifestAtCompileTimeWithProjecthook.aspx" target="_blank">Craig Boyd: Apply Application Manifest At Compile Time With ProjectHook</a></p>
<p><a href="http://www.bingo-ev.de/~mw368/vfp9_vista.html" target="_blank">Markus Winhard: ManifestTools.zip (based on code from Calvin’s blog above)</a></p>
<p>If you are not comfortable with messing around with manifest files, the SetProcessDPIAware API function is the way to go. Just be sure it only runs on Vista/Win7/Win8 (or call it in a TRY-CATCH-ENDTRY block) to prevent an error in pre-Vista versions of Windows!</p>
<p>Additional thoughts and (better) explanations of DPI-awareness in Vista can be found in the following article: <a href="http://www.rw-designer.com/DPI-aware" target="_blank">http://www.rw-designer.com/DPI-aware</a></p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<div class="nav-previous"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/windows-is-lying-to-you-with-dpi-virtualization/" rel="prev"><span class="meta-nav">&larr; Previous Post</span> Windows Is Lying To You&#8230; With DPI Virtualization</a></div><div class="nav-next"><a href="/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/paint-it-almost-black/" rel="next"><span class="meta-nav">Next Post &rarr;</span> Paint It (Almost) Black</a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
		
		</main><!-- #main -->
	</div><!-- #primary -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
			<a class="powered-by" href="http://wordpress.org/">Proudly powered by WordPress</a>
			<span class="sep"> | </span>
			Theme: editor by <a href="https://array.is/">Array</a>		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	<div style="display:none">
	</div>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/plugins/jetpack/modules/photon/photon.js?ver=20130122'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201725'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2017Junaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.8'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/themes/editor/js/jquery.fitvids.js?ver=20140820'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/themes/editor/js/editor.js?ver=20120206'></script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-includes/js/wp-embed.min.js?ver=4.8'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"kevinragsdale"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/uploads/2017/06/wp-static-html-output-1-1498057010-kragsdale/is-your-app-dpi-aware/kevinragsdale.github.io/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.8'></script>
<script type='text/javascript' src='https://stats.wp.com/e-201725.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:5.0',blog:'34471053',post:'925',tz:'-5',srv:''} ]);
	_stq.push([ 'clickTrackerInit', '34471053', '925' ]);
</script>

</body>
</html>
