<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">

<title>programming Archives - Kevin Ragsdale</title>

<!-- This site is optimized with the Yoast SEO plugin v4.9 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="/tag/programming-2/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="object" />
<meta property="og:title" content="programming Archives - Kevin Ragsdale" />
<meta property="og:url" content="/tag/programming-2/" />
<meta property="og:site_name" content="Kevin Ragsdale" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Kevin Ragsdale &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="Kevin Ragsdale &raquo; Comments Feed" href="/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Kevin Ragsdale &raquo; programming Tag Feed" href="/tag/programming-2/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='editor-style-css'  href='/wp-content/themes/editor/style.css?ver=4.8' type='text/css' media='all' />
<link rel='stylesheet' id='editor-font-awesome-css-css'  href='/wp-content/themes/editor/inc/fontawesome/font-awesome.css?ver=4.1.0' type='text/css' media='screen' />
<!--[if IE]>
<link rel='stylesheet' id='ie7-style-css'  href='/wp-content/themes/editor/inc/styles/ie.css?ver=4.8' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='editor-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C600%2C700%2C400italic%2C600italic%2C700italic%7CRoboto+Condensed%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='/wp-content/plugins/jetpack/css/jetpack.css?ver=5.0' type='text/css' media='all' />
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.8" />

<link rel='dns-prefetch' href='//v0.wordpress.com'>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<style type='text/css'>img#wpstats{display:none}</style>
<!-- Styles cached and displayed inline for speed. Generated by http://stylesplugin.com -->
<style type="text/css" id="styles-plugin-css">

</style>
</head>

<body class="archive tag tag-programming-2 tag-69 styles">

<div id="page" class="hfeed site container">

	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<!-- Get sidebar color option (Appearance -> Customize -> Theme Options) -->
		<header id="masthead" class="site-header dark" role="banner">
		<!-- Tab navigation -->
		<ul class="toggle-bar" role="tablist">
			<!-- Main navigation -->
			<li id="panel-1" class="current" role="presentation">
				<a href="#tab-1" role="tab" aria-controls="tab-1" aria-selected="true" class="current nav-toggle" data-tab="tab-1"><i class="fa fa-bars"></i><span class="screen-reader-text">View menu</span></a>
			</li>

			<!-- Featured Posts navigation -->
							<li id="panel-2" role="presentation">
					<a href="#tab-2" role="tab" aria-controls="tab-2" aria-selected="false" data-tab="tab-2"><i class="fa fa-thumb-tack"></i><span class="screen-reader-text">View featured posts</span></a>
				</li>
			
			<!-- Sidebar widgets navigation -->
			<li id="panel-3" role="presentation">
				<a href="#tab-3" role="tab" aria-controls="tab-3" aria-selected="false" class="folder-toggle" data-tab="tab-3"><i class="fa fa-folder"></i><i class="fa fa-folder-open"></i><span class="screen-reader-text">View sidebar</span></a>
			</li>
		</ul>

		<div id="tabs" class="toggle-tabs">
			<div class="site-header-inside">
				<!-- Logo, description and main navigation -->
				<div id="tab-1" class="tab-content current fadeIn">
					<div class="site-branding">
						<!-- Get the site branding -->
													<h1 class="site-title"><a href="/" rel="home">Kevin Ragsdale</a></h1>
							<h2 class="site-description">FoxPro Programming and Visual FoxPro 9</h2>
											</div>

					<nav id="site-navigation" class="main-navigation" role="navigation">
						<div class="menu-nav-container"><ul id="menu-nav" class="menu"><li id="menu-item-1421" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1421"><a href="/downloads-2/">Downloads</a></li>
<li id="menu-item-1417" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1417"><a href="/visual-foxpro-books/">Visual FoxPro Books</a></li>
<li id="menu-item-2269" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2269"><a href="/visual-foxpro-flls/">Visual FoxPro FLLs</a></li>
<li id="menu-item-1196" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1196"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/">It&#8217;s So, Uh, Gray</a></li>
</ul></div>					</nav><!-- #site-navigation -->

									</div><!-- #tab-1 -->

				<!-- Featured Posts template (template-featured-posts.php) -->
				
									<div id="tab-2" class="widget-area tab-content animated fadeIn">
						<div class="widget featured-posts-widget">
							<h2 class="widget-title">Multithreaded Visual FoxPro</h2>

							<div class="featured-posts">
							    
																	<div class="featured-post">
																	            <h3><a href="/please-release-me/" rel="bookmark">Please RELEASE Me</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/please-release-me/" rel="bookmark"><time class="entry-date published" datetime="2012-07-24T07:51:37+00:00">July 24, 2012</time><time class="updated" datetime="2014-06-07T09:59:24+00:00">June 7, 2014</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/easy-multithreading-with-visual-foxpro/" rel="bookmark">Easy Multithreading with Visual FoxPro</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/easy-multithreading-with-visual-foxpro/" rel="bookmark"><time class="entry-date published" datetime="2012-07-14T07:09:03+00:00">July 14, 2012</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/shameless-self-promotion/" rel="bookmark">Shameless Self-Promotion</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/shameless-self-promotion/" rel="bookmark"><time class="entry-date published" datetime="2012-06-12T13:06:43+00:00">June 12, 2012</time><time class="updated" datetime="2015-06-06T08:36:56+00:00">June 6, 2015</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/christof-is-a-freaking-genius/" rel="bookmark">Christof Is A Freaking Genius</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/christof-is-a-freaking-genius/" rel="bookmark"><time class="entry-date published" datetime="2010-09-01T09:10:15+00:00">September 1, 2010</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																							</div><!-- .featured-posts -->
						</div><!-- .featured-posts-widget -->
					</div><!-- #tab-2 .widget-area -->
				
				<!-- Sidebar widgets -->
				<div id="tab-3" class="tab-content animated fadeIn" role="tabpanel" aria-labelledby="panel-3" aria-hidden="true">
						<div id="secondary" class="widget-area" role="complementary">
		<aside id="categories-2" class="widget widget_categories"><h2 class="widget-title">Categories</h2>		<ul>
	<li class="cat-item cat-item-2"><a href="/category/books/" title="There are many great books about Visual FoxPro. My favorites are from Hentzenwerke Publishing. All of the titles from Hentzenwerke are well-written, concise, and provide excellent information. Highly recommended!">Books</a> (3)
</li>
	<li class="cat-item cat-item-3"><a href="/category/conferences-blog/" >Conferences</a> (28)
</li>
	<li class="cat-item cat-item-4"><a href="/category/desktop-alerts/" >Desktop Alerts</a> (9)
</li>
	<li class="cat-item cat-item-5"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/" title="Posts from my Southwest Fox 2011 session titled, &quot;It&#039;s so, uh, gray... Tips &amp; Tricks to Improve Your Apps Interface&quot;">It&#039;s So, Uh, Gray</a> (19)
</li>
	<li class="cat-item cat-item-6"><a href="/category/multithreaded-visual-foxpro/" title="Posts related to my  Southwest Fox 2011 session titled, &quot;Easy Multithreading with Visual FoxPro&quot; (based on Christof Wollenhaupt&#039;s DMULT.DLL)">Multithreaded Visual FoxPro</a> (4)
</li>
	<li class="cat-item cat-item-135"><a href="/category/personal/" >Personal</a> (9)
</li>
	<li class="cat-item cat-item-7"><a href="/category/programming/" >Programming</a> (26)
</li>
	<li class="cat-item cat-item-8"><a href="/category/screencasts/" title="Screencasts on a variety of topics related to Visual FoxPro programming">Screencasts</a> (5)
</li>
	<li class="cat-item cat-item-9"><a href="/category/visual-fox-pro-user-groups/" >User Groups</a> (5)
</li>
	<li class="cat-item cat-item-141"><a href="/category/visual-foxpro/" title="General items related to Visual FoxPro">Visual FoxPro</a> (15)
</li>
		</ul>
</aside><aside id="text-8" class="widget widget_text">			<div class="textwidget"><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-875609-8', 'auto');
  ga('send', 'pageview');

</script></div>
		</aside>	</div><!-- #secondary -->
				</div><!-- #tab-3 -->
			</div><!-- .site-header-inside -->
		</div><!-- #tabs -->
	</header><!-- #masthead -->

	<div id="content" class="site-content fadeInFast">

	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
			<header class="page-header">
				<h1 class="page-title">
					Tag / programming				</h1>
							</header><!-- .page-header -->

			<!-- If author has a bio, show it. -->
			
						
				
<article id="post-913" class="post post-913 type-post status-publish format-standard hentry category-tips-and-tricks-to-improve-your-apps-ui tag-design tag-foxpro tag-programming-2 tag-visual-foxpro-2 tag-winapi tag-windows">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/windows-is-lying-to-you-with-dpi-virtualization/" rel="bookmark"><time class="entry-date published" datetime="2013-01-02T05:00:45+00:00">January 2, 2013</time><time class="updated" datetime="2014-06-15T08:22:58+00:00">June 15, 2014</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/windows-is-lying-to-you-with-dpi-virtualization/" rel="bookmark">Windows Is Lying To You&#8230; With DPI Virtualization</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
			<div class="entry-excerpt">
			<p>Windows lies, and Kevin cries, because his apps are blurry&#8230;</p>
		</div>
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a></li>
							<li class="meta-tag"><a href="/tag/design/" rel="tag">design</a>, <a href="/tag/foxpro/" rel="tag">foxpro</a>, <a href="/tag/programming-2/" rel="tag">programming</a>, <a href="/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/tag/winapi/" rel="tag">winapi</a>, <a href="/tag/windows/" rel="tag">windows</a></li>
							</ul>
</div>
	<div class="entry-content">
		<h1>DPI Virtualization in Windows</h1>
<p>Windows Vista (and subsequently, Windows 7 &amp; 8) introduced a new feature called <a title="MSDN explanation of DPI Virtualization" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd464660(v=vs.85).aspx#dpi_virtualization" target="_blank">DPI Virtualization</a>.</p>
<p>DPI Virtualization means Windows will automatically “resize” your forms and form objects for you, with no coding or resizing required on your part.</p>
<p>Sounds great, doesn&#8217;t it? Well, not quite. Remember my “ugly” <a title="Blurry form" href="http://kevinragsdale.info/wp-content/uploads/2012/12/Blurry.png" target="_blank">form</a> in an <a title="So, What Is An Ugly App Anyway?" href="/so-what-is-an-ugly-app-anyway/" target="_blank">earlier post</a>, running at 144dpi? It was DPI Virtualized by Windows 7, and the result was a blurry window.</p>
<p>DPI Virtualization also requires the code listing from a <a title="Respecting The User’s Font Settings" href="/respecting-the-users-font-settings/" target="_blank">previous post</a> to fail, every time. Why? Because when the code asks Windows, “Hey, what’s the current setting?”, Windows Vista, 7 and 8 will always answer “your font factor is 1” (no resizing required) <em>if the user has selected to use DPI Virtualization</em>.</p>
<p>“Whoa, whoa, whoa, Kevin! <em><strong>If</strong> the user has selected DPI Virtualization</em>?”</p>
<p>Yes. Windows Vista, 7 and 8 have two different modes of DPI scaling: XP Style, and DPI Virtualization.</p>
<div id="attachment_914" style="width: 404px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Unchecked.png"><img class="size-full wp-image-914" alt="Setting the DPI scale mode in Windows 7" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Unchecked.png?resize=394%2C283" srcset="https://i1.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Unchecked.png?w=394&amp;ssl=1 394w, https://i1.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Unchecked.png?resize=300%2C215&amp;ssl=1 300w" sizes="(max-width: 394px) 100vw, 394px" data-recalc-dims="1" /></a><p class="wp-caption-text">Setting the DPI scale mode in Windows 7</p></div>
<p>If the user changes her DPI setting, and checks the “Use Windows XP style DPI scaling” checkbox, Windows Vista, 7 and 8 will return the expected (truthful) result from the previous code listing – just like XP did.</p>
<p>So, a DPI of 144dpi (150%) with this box unchecked, results in the following:</p>
<div id="attachment_915" style="width: 340px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/XPStyle.png"><img class="size-full wp-image-915" alt="The correct font factor with XP style scaling turned on" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/XPStyle.png?resize=330%2C249" srcset="https://i0.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/XPStyle.png?w=330&amp;ssl=1 330w, https://i0.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/XPStyle.png?resize=300%2C226&amp;ssl=1 300w" sizes="(max-width: 330px) 100vw, 330px" data-recalc-dims="1" /></a><p class="wp-caption-text">The correct font factor with XP style scaling turned on</p></div>
<p>And, just like I would do with the XP result from earlier, I would want to resize my forms and form objects, making them 50% larger than “normal.”</p>
<p>But if the user has not checked the box, here’s what Windows tells me about the “font factor” (notice the messagebox is also a bit blurry):</p>
<div id="attachment_916" style="width: 394px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Blurry2.png"><img class="size-full wp-image-916" alt="Thanks, Windows, for lying and making my forms blurry" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Blurry2.png?resize=384%2C301" srcset="https://i2.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Blurry2.png?w=384&amp;ssl=1 384w, https://i2.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Blurry2.png?resize=300%2C235&amp;ssl=1 300w" sizes="(max-width: 384px) 100vw, 384px" data-recalc-dims="1" /></a><p class="wp-caption-text">Thanks, Windows, for lying to me and making my forms blurry</p></div>
<p>Great. The user has selected 144dpi, but my app does not know this because Windows has said, “Don’t worry, no need to resize anything. All is good.”</p>
<p>And my user gets to see “somewhat” resized, yet blurry, forms in my app.</p>
<p>What we need is a “Windows Lie Detector” to make sure Windows stops lying to us.</p>
<p>How do we do this?</p>
<p>We need to tell Windows that the app is “DPI Aware”.</p>
<p>And that&#8217;s exactly what we&#8217;ll look at in tomorrow&#8217;s post.</p>
<p>&nbsp;</p>
<h3>Related Links (With much better explanations)</h3>
<p><a title="A much better explanation" href="http://www.kynosarges.org/WindowsDpi.html" target="_blank">High DPI Settings In Windows<br />
</a><a title="Fixing Windows Programming" href="http://news.kynosarges.org/2012/07/10/fixing-windows-programming/" target="_blank">Fixing Windows Programming</a></p>
<p>&nbsp;</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-38" class="post post-38 type-post status-publish format-standard hentry category-programming tag-programming-2">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/set-procedure-to-mydll/" rel="bookmark"><time class="entry-date published" datetime="2011-05-28T17:20:58+00:00">May 28, 2011</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/set-procedure-to-mydll/" rel="bookmark">SET PROCEDURE TO MyDll</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/programming/" rel="category tag">Programming</a></li>
							<li class="meta-tag"><a href="/tag/programming-2/" rel="tag">programming</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p>I use the Microsoft Web Browser Control as the primary UI for an app. This means I need a ton of support files like cascading stylesheets, javascript files, images, etc.</p>
<p>Typically, I create a subfolder in the Windows &#8220;Temp&#8221; (SYS(2023)) folder for the HTML files, then subfolders for each of the support file types (CSS, JS, IMG). I don&#8217;t like to install the support files with the app, because there&#8217;s always <em><strong>someone</strong></em> out there that wants to modify the files or just poke around to see how some things get done.</p>
<p>In the past, I simply included the support files in the EXE and did a series of STRTOFILE()&#8217;s to copy the files to the temporary location. But as the app (and the number of support files it uses) grows, it really bloats the EXE. So I created a DLL which contained all the included files, with methods to do the file copying.</p>
<p>During startup, the EXE instantiates the OLEPUBLIC classes in the DLL and fires the methods to copy the files. Works great, and it keeps the size of the EXE a bit smaller.</p>
<p>Yep, works great. Except when the DLL doesn’t get properly registered during the install, and the instantiation fails. I get error reports from time to time where the DLL hasn’t been registered. Though I’ve been unable to recreate it here, it seems the common denominator is a particular anti-virus software solution – I&#8217;m looking at <em>you</em>, Kaspersky.</p>
<p>So, I’m stuck with needing to manually register the DLL if it hasn’t been registered. I suppose I could use Reg-Free COM, manifest files, elevation, etc. to register the DLL programmatically, but I worry about going through all of that only to find that it still won’t register for the same reason it didn’t during installation (I&#8217;m <em>still</em> looking at <em>you</em>, Kaspersky).</p>
<p>I stumbled on an idea earlier this week and thought I’d give it a try. The idea was to SET PROCEDURE TO MyDll. Why not create a DLL, then, instead of going through registering it, just SET PROCEDURE to it and call the methods?</p>
<p>Duh. Can’t do it. It’s an object method, and I haven’t created the object.</p>
<p>So I did a little refactoring on the DLL. It contains one OLEPUBLIC class, which is nothing more than a class definition – no properties, no methods, no nothing. Then I split the methods out to simple FUNCTIONs.</p>
<p>Recompiled the DLL, then got rid of the registration info that was added to the Windows Registry. Then I tried the SET PROCEDURE TO.</p>
<p>The pseudocode looks like this:</p>
<pre>IF MyDll.dll Exists then
   SET PROCEDURE TO MyDll.dll
   MyFunction()
   RELEASE PROCEDURE MyDll.dll
ENDIF</pre>
<p>And, it worked! No registration, just a simple check to see if the file exists. If it does, run the method. This assumes, of course, that the method exists (since there’s no PEMSTATUS I can check – remember, no object or class exists).</p>
<p>Now for the disclaimer (before the comments start rolling in):</p>
<ol>
<li>Yes, I am well aware that SET PROCEDURE TO was not designed to be used this way.</li>
<li>Yes, I know the best way to &#8220;fix&#8221; the problem is to determine what the problem actually is and find a &#8220;real&#8221; solution.</li>
<li>Yes, I know this wouldn’t be considered &#8220;best practice&#8221;.</li>
</ol>
<p>On the other hand, though, my purpose for this is pretty specific, and was completed very quickly. Plus, with a little bit of coding on the app&#8217;s update procedure, I can now update the DLL anytime I need to, without having to install a whole new update. Best of all, it appears that the problem has been solved.  I still try to instantiate the object first, but if it fails I fallback to the new &#8220;unregistered&#8221; DLL. Not a single error report since the last update.</p>
<p>So far, so good…</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-40" class="post post-40 type-post status-publish format-standard hentry category-programming tag-programming-2 tag-vfpencryption">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/ive-seen-this-before-its-an-outlier/" rel="bookmark"><time class="entry-date published" datetime="2011-05-08T20:23:50+00:00">May 8, 2011</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/ive-seen-this-before-its-an-outlier/" rel="bookmark">I&#8217;ve Seen This Before. It&#8217;s An Outlier.</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/programming/" rel="category tag">Programming</a></li>
							<li class="meta-tag"><a href="/tag/programming-2/" rel="tag">programming</a>, <a href="/tag/vfpencryption/" rel="tag">vfpencryption</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p><strong>UPDATE: Finally figured out this issue. I was encrypting an XML file, which caused some illegal characters to appear from time to time (the &#8220;outlier&#8221; instances). Took out the header of the XML file, and everything works as expected.</strong></p>
<p>I recently added some functionality to an app which allows the app to login to a web service with a username and password. Since I want to retain the login information (so the user doesn’t have to be prompted to enter their credentials every time), I store the username and password in an XML “settings” file.</p>
<p>I’ve been using <a title="SPS Blog" href="http://www.sweetpotatosoftware.com/spsblog/" target="_blank">Craig Boyd</a>’s excellent <a href="http://www.sweetpotatosoftware.com/spsblog/2009/08/09/MajorVFPEncryptionUpdate.aspx" target="_blank">VFPEncryption FLL</a> to encrypt/decrypt the password. The user enters her username and password, the password is encrypted, and the username and password are written to the XML file. It’s been working great on thousands of computers.</p>
<p><em>Except for four computers</em>.</p>
<p>When the app needs to retrieve the username and password, it opens the XML file, decrypts the password, and tries to login to the web service. But on these four computers, the decryption crashes with “API call caused an exception”.</p>
<p>Working with a customer on this particular problem, I pointed him to the XML file and asked him if he would be willing to change his password for the web service – just to see if maybe we could get past the crash.</p>
<p>He changed a couple of characters in his password, and voila! – it worked with no problem.</p>
<p>So he went back to his original password and made note of the encrypted password which was stored in the XML file. Oddly, the encrypted password contained an embedded carriage return:</p>
<blockquote><p>&lt;PASSWORD&gt;?-arP?­Z?=¤¨?? ;?¥<br />
?8??*ù©y&lt;/PASSWORD&gt;</p></blockquote>
<p>He changed a couple of characters, and made note of the encrypted password again:</p>
<blockquote><p>&lt;PASSWORD&gt;ðF&#8217;1L&#8217;|„ žU­MU¨èˆfâ‚?TÀn Çvõ&#8217;U&lt;/PASSWORD&gt;</p></blockquote>
<p>Freaky, huh? When I run the code from the app via the Visual FoxPro Command Window, including the STRTOFILE() and FILETOSTR() lines to write and read the XML file, it works with no problem.</p>
<p>The customer, a former software developer, tried 16 more random passwords – just to see what would happen. Every one of them worked flawlessly.</p>
<p>So, after successfully trying 17 passwords he went back to the original. Same problem: an embedded carriage return in the stored encrypted password, and an API exception when decrypting it.</p>
<p>The last thing he said to me was:</p>
<blockquote><p>Then it hit me, not the first time I&#8217;ve seen this. <strong>It&#8217;s an outlier</strong>. There is a very good reason why this is happening. You may close the ticket now. The function is working fine.</p></blockquote>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-286" class="post post-286 type-post status-publish format-standard hentry category-programming tag-dll-hell tag-programming-2">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/if-you-write-visual-foxpro-apps/" rel="bookmark"><time class="entry-date published" datetime="2010-03-13T17:03:54+00:00">March 13, 2010</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/if-you-write-visual-foxpro-apps/" rel="bookmark">If You Write Visual FoxPro Apps…</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/programming/" rel="category tag">Programming</a></li>
							<li class="meta-tag"><a href="/tag/dll-hell/" rel="tag">dll hell</a>, <a href="/tag/programming-2/" rel="tag">programming</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p>If you’re a Visual FoxPro developer,<br />
and you like to install the VFP runtime files in<br />
the WindowsSystem32 folder,</p>
<p>Please…</p>
<p><strong>STOP</strong>.</p>
<p><a title="/dll-hell-rears-its-ugly-head" href="/dll-hell-rears-its-ugly-head">/dll-hell-rears-its-ugly-head</a></p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
			
		
		</main><!-- #main -->
	</section><!-- #primary -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
			<a class="powered-by" href="http://wordpress.org/">Proudly powered by WordPress</a>
			<span class="sep"> | </span>
			Theme: editor by <a href="https://array.is/">Array</a>		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	<div style="display:none">
	</div>
<script type='text/javascript' src='/wp-content/plugins/jetpack/modules/photon/photon.js?ver=20130122'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201725'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2017Junaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.8'></script>
<script type='text/javascript' src='/wp-content/themes/editor/js/jquery.fitvids.js?ver=20140820'></script>
<script type='text/javascript' src='/wp-content/themes/editor/js/editor.js?ver=20120206'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.8'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"kevinragsdale"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.8'></script>
<script type='text/javascript' src='https://stats.wp.com/e-201725.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:5.0',blog:'34471053',post:'0',tz:'-5',srv:'kevinragsdale.net'} ]);
	_stq.push([ 'clickTrackerInit', '34471053', '0' ]);
</script>

</body>
</html>
