<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">

<title>foxpro Archives - Kevin Ragsdale</title>

<!-- This site is optimized with the Yoast SEO plugin v4.9 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="/tag/foxpro/" />
<link rel="next" href="/tag/foxpro/page/2/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="object" />
<meta property="og:title" content="foxpro Archives - Kevin Ragsdale" />
<meta property="og:url" content="/tag/foxpro/" />
<meta property="og:site_name" content="Kevin Ragsdale" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Kevin Ragsdale &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="Kevin Ragsdale &raquo; Comments Feed" href="/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Kevin Ragsdale &raquo; foxpro Tag Feed" href="/tag/foxpro/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='editor-style-css'  href='/wp-content/themes/editor/style.css?ver=4.8' type='text/css' media='all' />
<link rel='stylesheet' id='editor-font-awesome-css-css'  href='/wp-content/themes/editor/inc/fontawesome/font-awesome.css?ver=4.1.0' type='text/css' media='screen' />
<!--[if IE]>
<link rel='stylesheet' id='ie7-style-css'  href='/wp-content/themes/editor/inc/styles/ie.css?ver=4.8' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='editor-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C600%2C700%2C400italic%2C600italic%2C700italic%7CRoboto+Condensed%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='/wp-content/plugins/jetpack/css/jetpack.css?ver=5.0' type='text/css' media='all' />
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.8" />

<link rel='dns-prefetch' href='//v0.wordpress.com'>
<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<style type='text/css'>img#wpstats{display:none}</style>
<!-- Styles cached and displayed inline for speed. Generated by http://stylesplugin.com -->
<style type="text/css" id="styles-plugin-css">

</style>
</head>

<body class="archive tag tag-foxpro tag-44 styles">

<div id="page" class="hfeed site container">

	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<!-- Get sidebar color option (Appearance -> Customize -> Theme Options) -->
		<header id="masthead" class="site-header dark" role="banner">
		<!-- Tab navigation -->
		<ul class="toggle-bar" role="tablist">
			<!-- Main navigation -->
			<li id="panel-1" class="current" role="presentation">
				<a href="#tab-1" role="tab" aria-controls="tab-1" aria-selected="true" class="current nav-toggle" data-tab="tab-1"><i class="fa fa-bars"></i><span class="screen-reader-text">View menu</span></a>
			</li>

			<!-- Featured Posts navigation -->
							<li id="panel-2" role="presentation">
					<a href="#tab-2" role="tab" aria-controls="tab-2" aria-selected="false" data-tab="tab-2"><i class="fa fa-thumb-tack"></i><span class="screen-reader-text">View featured posts</span></a>
				</li>
			
			<!-- Sidebar widgets navigation -->
			<li id="panel-3" role="presentation">
				<a href="#tab-3" role="tab" aria-controls="tab-3" aria-selected="false" class="folder-toggle" data-tab="tab-3"><i class="fa fa-folder"></i><i class="fa fa-folder-open"></i><span class="screen-reader-text">View sidebar</span></a>
			</li>
		</ul>

		<div id="tabs" class="toggle-tabs">
			<div class="site-header-inside">
				<!-- Logo, description and main navigation -->
				<div id="tab-1" class="tab-content current fadeIn">
					<div class="site-branding">
						<!-- Get the site branding -->
													<h1 class="site-title"><a href="/" rel="home">Kevin Ragsdale</a></h1>
							<h2 class="site-description">FoxPro Programming and Visual FoxPro 9</h2>
											</div>

					<nav id="site-navigation" class="main-navigation" role="navigation">
						<div class="menu-nav-container"><ul id="menu-nav" class="menu"><li id="menu-item-1421" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1421"><a href="/downloads-2/">Downloads</a></li>
<li id="menu-item-1417" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1417"><a href="/visual-foxpro-books/">Visual FoxPro Books</a></li>
<li id="menu-item-2269" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2269"><a href="/visual-foxpro-flls/">Visual FoxPro FLLs</a></li>
<li id="menu-item-1196" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1196"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/">It&#8217;s So, Uh, Gray</a></li>
</ul></div>					</nav><!-- #site-navigation -->

									</div><!-- #tab-1 -->

				<!-- Featured Posts template (template-featured-posts.php) -->
				
									<div id="tab-2" class="widget-area tab-content animated fadeIn">
						<div class="widget featured-posts-widget">
							<h2 class="widget-title">Multithreaded Visual FoxPro</h2>

							<div class="featured-posts">
							    
																	<div class="featured-post">
																	            <h3><a href="/please-release-me/" rel="bookmark">Please RELEASE Me</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/please-release-me/" rel="bookmark"><time class="entry-date published" datetime="2012-07-24T07:51:37+00:00">July 24, 2012</time><time class="updated" datetime="2014-06-07T09:59:24+00:00">June 7, 2014</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/easy-multithreading-with-visual-foxpro/" rel="bookmark">Easy Multithreading with Visual FoxPro</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/easy-multithreading-with-visual-foxpro/" rel="bookmark"><time class="entry-date published" datetime="2012-07-14T07:09:03+00:00">July 14, 2012</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/shameless-self-promotion/" rel="bookmark">Shameless Self-Promotion</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/shameless-self-promotion/" rel="bookmark"><time class="entry-date published" datetime="2012-06-12T13:06:43+00:00">June 12, 2012</time><time class="updated" datetime="2015-06-06T08:36:56+00:00">June 6, 2015</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																	<div class="featured-post">
																	            <h3><a href="/christof-is-a-freaking-genius/" rel="bookmark">Christof Is A Freaking Genius</a></h3>

							            <div class="featured-post-meta">
								            <div class="featured-post-date">
								            	<i class="fa fa-clock-o"></i>
								            	<span class="posted-on"><a href="/christof-is-a-freaking-genius/" rel="bookmark"><time class="entry-date published" datetime="2010-09-01T09:10:15+00:00">September 1, 2010</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>								            </div>
							            </div>
									</div>
																							</div><!-- .featured-posts -->
						</div><!-- .featured-posts-widget -->
					</div><!-- #tab-2 .widget-area -->
				
				<!-- Sidebar widgets -->
				<div id="tab-3" class="tab-content animated fadeIn" role="tabpanel" aria-labelledby="panel-3" aria-hidden="true">
						<div id="secondary" class="widget-area" role="complementary">
		<aside id="categories-2" class="widget widget_categories"><h2 class="widget-title">Categories</h2>		<ul>
	<li class="cat-item cat-item-2"><a href="/category/books/" title="There are many great books about Visual FoxPro. My favorites are from Hentzenwerke Publishing. All of the titles from Hentzenwerke are well-written, concise, and provide excellent information. Highly recommended!">Books</a> (3)
</li>
	<li class="cat-item cat-item-3"><a href="/category/conferences-blog/" >Conferences</a> (28)
</li>
	<li class="cat-item cat-item-4"><a href="/category/desktop-alerts/" >Desktop Alerts</a> (9)
</li>
	<li class="cat-item cat-item-5"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/" title="Posts from my Southwest Fox 2011 session titled, &quot;It&#039;s so, uh, gray... Tips &amp; Tricks to Improve Your Apps Interface&quot;">It&#039;s So, Uh, Gray</a> (19)
</li>
	<li class="cat-item cat-item-6"><a href="/category/multithreaded-visual-foxpro/" title="Posts related to my  Southwest Fox 2011 session titled, &quot;Easy Multithreading with Visual FoxPro&quot; (based on Christof Wollenhaupt&#039;s DMULT.DLL)">Multithreaded Visual FoxPro</a> (4)
</li>
	<li class="cat-item cat-item-135"><a href="/category/personal/" >Personal</a> (9)
</li>
	<li class="cat-item cat-item-7"><a href="/category/programming/" >Programming</a> (26)
</li>
	<li class="cat-item cat-item-8"><a href="/category/screencasts/" title="Screencasts on a variety of topics related to Visual FoxPro programming">Screencasts</a> (5)
</li>
	<li class="cat-item cat-item-9"><a href="/category/visual-fox-pro-user-groups/" >User Groups</a> (5)
</li>
	<li class="cat-item cat-item-141"><a href="/category/visual-foxpro/" title="General items related to Visual FoxPro">Visual FoxPro</a> (15)
</li>
		</ul>
</aside><aside id="text-8" class="widget widget_text">			<div class="textwidget"><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-875609-8', 'auto');
  ga('send', 'pageview');

</script></div>
		</aside>	</div><!-- #secondary -->
				</div><!-- #tab-3 -->
			</div><!-- .site-header-inside -->
		</div><!-- #tabs -->
	</header><!-- #masthead -->

	<div id="content" class="site-content fadeInFast">

	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
			<header class="page-header">
				<h1 class="page-title">
					Tag / foxpro				</h1>
							</header><!-- .page-header -->

			<!-- If author has a bio, show it. -->
			
						
				
<article id="post-1100" class="post post-1100 type-post status-publish format-standard hentry category-tips-and-tricks-to-improve-your-apps-ui tag-class tag-foxpro tag-label tag-subclass tag-visual-foxpro-2 tag-windows">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/a-hyperlink-class-subclassing-the-label-control/" rel="bookmark"><time class="entry-date published" datetime="2013-02-21T09:16:54+00:00">February 21, 2013</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/a-hyperlink-class-subclassing-the-label-control/" rel="bookmark">A Hyperlink Class: Subclassing the Label Control</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
			<div class="entry-excerpt">
			<p>From a series of posts on subclassing Visual FoxPro controls: the Label control.</p>
		</div>
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a></li>
							<li class="meta-tag"><a href="/tag/class/" rel="tag">class</a>, <a href="/tag/foxpro/" rel="tag">foxpro</a>, <a href="/tag/label/" rel="tag">label</a>, <a href="/tag/subclass/" rel="tag">subclass</a>, <a href="/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/tag/windows/" rel="tag">windows</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p><strong>Updated December 18, 2013: Source code for lblHyperlink is <a title="lblHyperlink Source Code" href="/source-code-lblhyperlink-subclassed-lbllabel/">available here</a>, parent class (lblLabel) source is <a title="lblLabel Source Code" href="/source-code-lbllabel-visual-foxpro-label-subclass/">available here</a>.</strong></p>
<h1><strong>The lblHyperlink label subclass</strong></h1>
<p>One of the more popular movements in desktop applications is &#8220;webification.&#8221; Users have become so used to the web interface via their browser, more and more desktop apps have added clickable hyperlinks as an important part of their UI. I&#8217;ve created a subclass of the lblLabel Visual FoxPro Label Control class to mimic a hyperlink.</p>
<p>This subclass of the contains the following properties which override the parent class:</p>
<pre>MousePointer = 15
ForeColor = RGB(0,102,204)
Name = "lblHyperlink"</pre>
<p>I set the ForeColor to a &#8220;blue&#8221;, simply for the visual cue in design time that I’m working with a &#8220;hyperlink&#8221; instead of a plain old label.</p>
<p>Plus a couple of other properties, for the ForeColor (we&#8217;ll change the ForeColor when the user hovers over the link):</p>
<pre>nForeColor = 0
nHoverColor = 0</pre>
<p>We&#8217;ll change the MousePointer to 15 (Hand), as a visual indication that it’s a link. I want the ForeColor of the link to be whatever Windows says the COLOR_HOTLIGHT (from GetSysColor()) should be for a hyperlink, and when the user hovers over the link I&#8217;ll change it to the COLOR_MENUHILIGHT value.</p>
<p>We’ll set the ForeColor (and hover color) in the Init event:</p>
<pre>PROCEDURE Init
  DODEFAULT()

  ** Use GetSysColor to get the hyperlink color
  DECLARE INTEGER GetSysColor IN "user32" INTEGER nIndex

  This.nForeColor = GetSysColor(26)  &amp;&amp; COLOR_HOTLIGHT
  This.nHoverColor = GetSysColor(29) &amp;&amp; MENU_HOTLIGHT
ENDPROC</pre>
<p>We&#8217;ll also add some code to the MouseEnter and MouseLeave events:</p>
<pre>PROCEDURE MouseEnter
  LPARAMETERS nButton, nShift, nXCoord, nYCoord
  WITH THIS
    .ForeColor = .nHoverColor
    .FontUnderline = .T.
    .Caption = .Caption
  ENDWITH
ENDPROC</pre>
<p>We set the ForeColor to the COLOR_MENUHILIGHT color and underline the label, just to provide an additional visual cue to the user at runtime that this is a hyperlink.</p>
<p>Notice the .Caption = .Caption line? I&#8217;ve seen “<a title="Stop The Bleeding!" href="/stop-the-bleeding/" target="_blank">bleeding</a>” with some form controls (including labels from time to time, when the app is minimized then restored) which have a BackStyle = 0 (Transparent). This line corrects the problem with &#8220;bleeding.&#8221;</p>
<p>The MouseLeave event looks like this:</p>
<pre>PROCEDURE MouseLeave
  LPARAMETERS nButton, nShift, nXCoord, nYCoord
  WITH THIS
    .ForeColor = .nForeColor
    .FontUnderline = .F.
    .Caption = .Caption
  ENDWITH
ENDPROC</pre>
<p>Once again we reset the ForeColor back to the COLOR_HOTLIGHT value in GetSysColor(). Then we remove the underline, and do the &#8220;bleeding&#8221; fix, just in case.</p>
<p>This is, of course, just basic functionality. To really make this shine, I recommend viewing Tamar Granor&#8217;s presentation &#8220;<a title="Tamar's Presentation on YouTube" href="http://www.youtube.com/watch?v=ALaoepuHE5U" target="_blank">BindEvents for Better Applications</a>&#8221; from the Online Visual FoxPro Users Group (<a title="Onlne FoxPro Users Group (Google Groups)" href="https://groups.google.com/forum/?fromgroups=#!forum/ofug" target="_blank">OFUG</a>) meeting (recorded on Tuesday, February 19, 2013).</p>
<p>And we&#8217;re done with the hyperlink!</p>
<p>Well, <em>almost</em> done. Since the hyperlink control is based on a Label, the link cannot get focus by using the keyboard. We need a way to be able to select (and click) the link without a mouse.</p>
<p>Enter, a container object.</p>
<h1><strong>The cntHyperlink container class</strong></h1>
<p>The cntHyperlink container class consists of a container object which contains the aforementioned lblHyperlink label and a CommandButton.</p>
<p>It is a subclass of cntContainer (shown below).</p>
<p>cntContainer has a custom abstract method named OnClick, which is called in the Click event:</p>
<pre>DEFINE CLASS cntContainer AS Container
  Width = 194
  Height = 75
  BackStyle = 0
  BorderWidth = 0
  Name = "cntContainer"

  PROCEDURE onclick
    ** Abstract method called by the Click() event
  ENDPROC

  PROCEDURE Click
    This.OnClick()
  ENDPROC
ENDDEFINE</pre>
<p>The cntHyperlink class has a custom property named cHotKey, which you could use as a hot key for the hyperlink:</p>
<pre>cHotKey = ""</pre>
<p>It also contains a lblHyperlink label. It remains the same, except we’ll add the following code in the OnClick() method which will &#8220;bubble up&#8221; to the parent container:</p>
<pre>PROCEDURE lblHyperlink.OnClick
  This.Parent.OnClick()
ENDPROC</pre>
<p>cntHyperlink container also has an OnClick() method, inherited from cntContainer.</p>
<p>We also have a CommandButton subclass added to the container. It contains the following events: LostFocus, GotFocus, and Init. It also contains a method named OnClick() (as do most of the controls in my base classes).</p>
<pre>PROCEDURE cmdButton.LostFocus
  This.Parent.LostFocus()
ENDPROC

PROCEDURE cmdButton.GotFocus
  This.Parent.GotFocus()
ENDPROC

PROCEDURE cmdButton.Init
  This.Height = 0
  This.Width = 0
ENDPROC

PROCEDURE cmdButton.OnClick
  This.Parent.OnClick()
ENDPROC</pre>
<p>Since it&#8217;s a hyperlink control, I don’t want the button to be visible on the form. In the Init event, we’ll size it to zero height and zero width. The GotFocus, LostFocus, and OnClick events simply &#8220;bubble up&#8221; to the parent container.</p>
<p>We’re done with the label and button, so all we have left is the container itself. In the Init, we add the following code which sets the Caption of the button to the cHotKey if it has been set:</p>
<pre>PROCEDURE Init
  DODEFAULT()

  IF !EMPTY(This.cHotKey)
    This.cmdButton.Caption = "&lt;" + This.cHotKey
  ENDIF
ENDPROC</pre>
<p>Since we&#8217;re &#8220;bubbling up&#8221; events from the command button, we’ll add the following code to the GotFocus and LostFocus events:</p>
<pre>PROCEDURE GotFocus
  WITH THIS
    .lblHyperlink.ForeColor = .lblHyperlink.nHoverColor
    .lblHyperlink.FontUnderline = .T.
  ENDWITH
ENDPROC

PROCEDURE LostFocus
  WITH THIS
    .lblHyperlink.ForeColor = .lblHyperlink.nForeColor
    .lblHyperlink.FontUnderline = .F.
  ENDWITH
ENDPROC</pre>
<p>And now we’re finally ready to place the instance of the cntHyperlink class on a form, complete with Tab Order functionality, hot key functionality, etc.</p>
<p>All we&#8217;ll need is to add the instance code for the container OnClick() method to handle the actual clicks on the hyperlink.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-940" class="post post-940 type-post status-publish format-standard hentry category-tips-and-tricks-to-improve-your-apps-ui category-programming tag-color tag-foxpro tag-label tag-visual-foxpro-2 tag-windows">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/paint-it-almost-black/" rel="bookmark"><time class="entry-date published" datetime="2013-01-04T05:00:55+00:00">January 4, 2013</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/paint-it-almost-black/" rel="bookmark">Paint It (Almost) Black</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
			<div class="entry-excerpt">
			<p>Got a label control you want to be black, all the time? Then paint it (almost) black.</p>
		</div>
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a>, <a href="/category/programming/" rel="category tag">Programming</a></li>
							<li class="meta-tag"><a href="/tag/color/" rel="tag">color</a>, <a href="/tag/foxpro/" rel="tag">foxpro</a>, <a href="/tag/label/" rel="tag">label</a>, <a href="/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/tag/windows/" rel="tag">windows</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p>In a <a title="So, What Is An Ugly App Anyway?" href="/so-what-is-an-ugly-app-anyway/" target="_blank">previous post</a>, I showed an ugly form. Ugly, because it looked <em>awful</em> when I ran the form with the Windows High Contrast Theme.</p>
<p>With the High Contrast Theme, normal black text appears yellow. Which is no problem at all when the text is drawn on a black background. But in my form, the text was drawn over a white shape control, and looked like this (the red arrows point to the yellow text):</p>
<div id="attachment_944" style="width: 568px" class="wp-caption alignnone"><a href="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/HighContrast2.png"><img class="size-full wp-image-944" alt="Yellow text on a white background" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/HighContrast2.png?resize=558%2C431" srcset="https://i2.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/HighContrast2.png?w=558&amp;ssl=1 558w, https://i2.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/HighContrast2.png?resize=300%2C231&amp;ssl=1 300w" sizes="(max-width: 558px) 100vw, 558px" data-recalc-dims="1" /></a><p class="wp-caption-text">Normal black text turns yellow in High Contrast #1 Theme.</p></div>
<p>So now I have a form that is unreadable in High Contrast. What I want to do is force Windows to draw the text black (since it is drawn over the white background).</p>
<p>&nbsp;</p>
<h3>There&#8217;s An Easy Fix For That!</h3>
<p>This is simple to do. I set the ForeColor of the labels that I want to appear as black to RGB(2,2,2). This color change from RGB(0,0,0) is imperceptible to the human eye (it still looks black), but Windows sees it as an absolute color. And since I have changed it to something other than the default, Windows will display the label in my “near-black” color (since it is not the &#8220;Default&#8221;).</p>
<p>After my session at Southwest Fox, a couple of people said they do the same thing I do to force a label to be black, but they use RGB(1,1,1). Not sure why I picked 2,2,2 – but they’re both “black” to the naked eye &#8212; and either setting works fine.</p>
<p>Here’s an example of an instance of my &#8220;near-black&#8221; label on a form (the top label ForeColor is RGB(0,0,0) – the Default), while the label inside the white shape has a ForeColor of RGB(2,2,2) – or, as I like to call it, “forced black”:</p>
<div id="attachment_945" style="width: 401px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/NearBlackNormal.png"><img class="size-full wp-image-945" alt="Two labels, two different ForeColors, same effect." src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/NearBlackNormal.png?resize=391%2C288" srcset="https://i0.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/NearBlackNormal.png?w=391&amp;ssl=1 391w, https://i0.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/NearBlackNormal.png?resize=300%2C220&amp;ssl=1 300w" sizes="(max-width: 391px) 100vw, 391px" data-recalc-dims="1" /></a><p class="wp-caption-text">Two labels, two different ForeColors, same effect.</p></div>
<p>And the same form, this time running in Windows High Contrast Theme:</p>
<div id="attachment_946" style="width: 393px" class="wp-caption alignnone"><a href="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/NearBlackHighContrast.png"><img class="size-full wp-image-946" alt="The &quot;near-black&quot; label stays black" src="https://i0.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/NearBlackHighContrast.png?resize=383%2C279" srcset="https://i1.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/NearBlackHighContrast.png?w=383&amp;ssl=1 383w, https://i1.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/NearBlackHighContrast.png?resize=300%2C218&amp;ssl=1 300w" sizes="(max-width: 383px) 100vw, 383px" data-recalc-dims="1" /></a><p class="wp-caption-text">The &#8220;near-black&#8221; label stays black.</p></div>
<p>Later in the series, we&#8217;ll look at creating sub-classes for different controls. This one I&#8217;ll call the lblForceBlack control, subclassed from a base Label class.</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-925" class="post post-925 type-post status-publish format-standard hentry category-tips-and-tricks-to-improve-your-apps-ui tag-design tag-dpi-virtualization tag-foxpro tag-setprocessdpiaware tag-visual-foxpro-2 tag-windows">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/is-your-app-dpi-aware/" rel="bookmark"><time class="entry-date published" datetime="2013-01-03T05:00:25+00:00">January 3, 2013</time><time class="updated" datetime="2015-06-06T08:51:02+00:00">June 6, 2015</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/is-your-app-dpi-aware/" rel="bookmark">Is Your App DPI-Aware?</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a></li>
							<li class="meta-tag"><a href="/tag/design/" rel="tag">design</a>, <a href="/tag/dpi-virtualization/" rel="tag">dpi virtualization</a>, <a href="/tag/foxpro/" rel="tag">foxpro</a>, <a href="/tag/setprocessdpiaware/" rel="tag">SetProcessDPIAware()</a>, <a href="/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/tag/windows/" rel="tag">windows</a></li>
							</ul>
</div>
	<div class="entry-content">
		<p>When you tell Windows Vista (and 7 &amp; 8) that your app is DPI-aware, Windows will not use DPI virtualization for your app and will no longer “lie” when you ask about the DPI settings.</p>
<p>Please note that by telling Windows that your app is DPI-aware, it is completely up to your app (you) to resize your UI in order to match user expectations based on their settings.</p>
<p>There are 2 different ways to tell Windows Vista, 7 and 8 that your app is DPI-aware:</p>
<ul>
<li>a Windows API function, or</li>
<li>adding a section to your apps manifest file.</li>
</ul>
<h3></h3>
<h3>Using a Windows API Function</h3>
<p>Windows Vista, 7 and 8 contain an API function named SetProcessDPIAware. The function has no parameters. It returns a zero if the function fails, and a non-zero result if the function succeeds.</p>
<p>Using it from within Visual FoxPro is easy:</p>
<pre>DECLARE INTEGER SetProcessDPIAware IN WIN32API
SetProcessDPIAware()</pre>
<p>The function simply tells Windows, “This app (process) is DPI Aware, so please do not lie to me. I will handle all of the resizing myself, so my users will see things the way they want to.”</p>
<p>Easy, right? Well, kind of. If you run the code listing above from the VFP Command Window, and if your Windows DPI setting has been set to 144dpi with DPI Virtualization turned on, you’ll get the correct (truthful) font factor from Windows (when you follow the API call with the code listing from a <a title="Respecting The User’s Font Settings" href="/respecting-the-users-font-settings/" target="_blank">previous post</a>).</p>
<p>BUT, remember this function has told Windows that this <em>process</em> is DPI-aware. And since you’re running the code from within the VFP IDE, you&#8217;re essentially telling Windows that <em>Visual FoxPro</em> is DPI-aware.</p>
<p>Unfortunately, Visual FoxPro is not DPI-aware, and has already been “DPI virtualized” by Windows. Causing Windows to suddenly accept that Visual FoxPro is DPI-aware can wreak havoc with the IDE.</p>
<p>If you don’t trust me on this, try it. It&#8217;s u-g-l-y!</p>
<p>So, one way we can force Windows to accept the fact that our app is DPI-aware is to simply call the SetProcessDPIAware function – preferably as early in your app as possible. I have seen several forum postings which report calling the function too late can cause Windows to continue to “lie” and use DPI virtualization anyway, though I have not recreated this problem myself.</p>
<p>&nbsp;</p>
<h3>Using Your App Manifest File</h3>
<p>Another way to tell Windows Vista (and 7) that the app is DPI-aware is to add the following section to your app manifest file:</p>
<pre>
&lt;asmv3:application xmlns:asmv3="urn:schemas-microsoft-com:asm.v3"&gt;
   &lt;asmv3:windowsSettings xmlns="http://schemas.microsoft.com/SMI/2005/WindowsSettings"&gt;
      &lt;dpiAware&gt;true&lt;/dpiAware&gt;
   &lt;/asmv3:windowsSettings&gt;
&lt;/asmv3:application&gt;
</pre>
<p>If you are not sure about manifest files and adding manifest resources to your Visual FoxPro applications, I recommend the following articles (I&#8217;ve been using Markus&#8217; Manifest Tools in my work):</p>
<p><a href="http://blogs.msdn.com/b/calvin_hsia/archive/2007/04/13/add-a-manifest-to-control-your-application-vista-uac-behavior.aspx" target="_blank">Calvin Hsia: Add a Manifest to Control Your Application Vista UAC Behavior</a></p>
<p><a href="https://web.archive.org/web/20150415195306/http://www.sweetpotatosoftware.com/spsblog/2009/08/03/ApplyApplicationManifestAtCompileTimeWithProjecthook.aspx" target="_blank">Craig Boyd: Apply Application Manifest At Compile Time With ProjectHook</a></p>
<p><a href="http://www.bingo-ev.de/~mw368/vfp9_vista.html" target="_blank">Markus Winhard: ManifestTools.zip (based on code from Calvin’s blog above)</a></p>
<p>If you are not comfortable with messing around with manifest files, the SetProcessDPIAware API function is the way to go. Just be sure it only runs on Vista/Win7/Win8 (or call it in a TRY-CATCH-ENDTRY block) to prevent an error in pre-Vista versions of Windows!</p>
<p>Additional thoughts and (better) explanations of DPI-awareness in Vista can be found in the following article: <a href="http://www.rw-designer.com/DPI-aware" target="_blank">http://www.rw-designer.com/DPI-aware</a></p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				
<article id="post-913" class="post post-913 type-post status-publish format-standard hentry category-tips-and-tricks-to-improve-your-apps-ui tag-design tag-foxpro tag-programming-2 tag-visual-foxpro-2 tag-winapi tag-windows">
	<!-- Grab the featured image -->
	
	<header class="entry-header">
				<div class="entry-date">
			<span class="posted-on"><a href="/windows-is-lying-to-you-with-dpi-virtualization/" rel="bookmark"><time class="entry-date published" datetime="2013-01-02T05:00:45+00:00">January 2, 2013</time><time class="updated" datetime="2014-06-15T08:22:58+00:00">June 15, 2014</time></a></span><span class="byline"> by </span> <span class="author vcard"><a class="url fn n" href="/author/kragsdale/">Kevin Ragsdale</a></span>		</div><!-- .entry-meta -->
		
		<h1 class="entry-title"><a href="/windows-is-lying-to-you-with-dpi-virtualization/" rel="bookmark">Windows Is Lying To You&#8230; With DPI Virtualization</a></h1>	</header><!-- .entry-header -->

	
<div class="entry-meta">
			<div class="entry-excerpt">
			<p>Windows lies, and Kevin cries, because his apps are blurry&#8230;</p>
		</div>
	
	<ul class="meta-list">
					<li class="meta-cat"><a href="/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a></li>
							<li class="meta-tag"><a href="/tag/design/" rel="tag">design</a>, <a href="/tag/foxpro/" rel="tag">foxpro</a>, <a href="/tag/programming-2/" rel="tag">programming</a>, <a href="/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/tag/winapi/" rel="tag">winapi</a>, <a href="/tag/windows/" rel="tag">windows</a></li>
							</ul>
</div>
	<div class="entry-content">
		<h1>DPI Virtualization in Windows</h1>
<p>Windows Vista (and subsequently, Windows 7 &amp; 8) introduced a new feature called <a title="MSDN explanation of DPI Virtualization" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd464660(v=vs.85).aspx#dpi_virtualization" target="_blank">DPI Virtualization</a>.</p>
<p>DPI Virtualization means Windows will automatically “resize” your forms and form objects for you, with no coding or resizing required on your part.</p>
<p>Sounds great, doesn&#8217;t it? Well, not quite. Remember my “ugly” <a title="Blurry form" href="http://kevinragsdale.info/wp-content/uploads/2012/12/Blurry.png" target="_blank">form</a> in an <a title="So, What Is An Ugly App Anyway?" href="/so-what-is-an-ugly-app-anyway/" target="_blank">earlier post</a>, running at 144dpi? It was DPI Virtualized by Windows 7, and the result was a blurry window.</p>
<p>DPI Virtualization also requires the code listing from a <a title="Respecting The User’s Font Settings" href="/respecting-the-users-font-settings/" target="_blank">previous post</a> to fail, every time. Why? Because when the code asks Windows, “Hey, what’s the current setting?”, Windows Vista, 7 and 8 will always answer “your font factor is 1” (no resizing required) <em>if the user has selected to use DPI Virtualization</em>.</p>
<p>“Whoa, whoa, whoa, Kevin! <em><strong>If</strong> the user has selected DPI Virtualization</em>?”</p>
<p>Yes. Windows Vista, 7 and 8 have two different modes of DPI scaling: XP Style, and DPI Virtualization.</p>
<div id="attachment_914" style="width: 404px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Unchecked.png"><img class="size-full wp-image-914" alt="Setting the DPI scale mode in Windows 7" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Unchecked.png?resize=394%2C283" srcset="https://i1.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Unchecked.png?w=394&amp;ssl=1 394w, https://i1.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Unchecked.png?resize=300%2C215&amp;ssl=1 300w" sizes="(max-width: 394px) 100vw, 394px" data-recalc-dims="1" /></a><p class="wp-caption-text">Setting the DPI scale mode in Windows 7</p></div>
<p>If the user changes her DPI setting, and checks the “Use Windows XP style DPI scaling” checkbox, Windows Vista, 7 and 8 will return the expected (truthful) result from the previous code listing – just like XP did.</p>
<p>So, a DPI of 144dpi (150%) with this box unchecked, results in the following:</p>
<div id="attachment_915" style="width: 340px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/XPStyle.png"><img class="size-full wp-image-915" alt="The correct font factor with XP style scaling turned on" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/XPStyle.png?resize=330%2C249" srcset="https://i0.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/XPStyle.png?w=330&amp;ssl=1 330w, https://i0.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/XPStyle.png?resize=300%2C226&amp;ssl=1 300w" sizes="(max-width: 330px) 100vw, 330px" data-recalc-dims="1" /></a><p class="wp-caption-text">The correct font factor with XP style scaling turned on</p></div>
<p>And, just like I would do with the XP result from earlier, I would want to resize my forms and form objects, making them 50% larger than “normal.”</p>
<p>But if the user has not checked the box, here’s what Windows tells me about the “font factor” (notice the messagebox is also a bit blurry):</p>
<div id="attachment_916" style="width: 394px" class="wp-caption alignnone"><a href="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Blurry2.png"><img class="size-full wp-image-916" alt="Thanks, Windows, for lying and making my forms blurry" src="https://i1.wp.com/kevinragsdale.info/wp-content/uploads/2013/01/Blurry2.png?resize=384%2C301" srcset="https://i2.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Blurry2.png?w=384&amp;ssl=1 384w, https://i2.wp.com/kevinragsdale.net/wp-content/uploads/2013/01/Blurry2.png?resize=300%2C235&amp;ssl=1 300w" sizes="(max-width: 384px) 100vw, 384px" data-recalc-dims="1" /></a><p class="wp-caption-text">Thanks, Windows, for lying to me and making my forms blurry</p></div>
<p>Great. The user has selected 144dpi, but my app does not know this because Windows has said, “Don’t worry, no need to resize anything. All is good.”</p>
<p>And my user gets to see “somewhat” resized, yet blurry, forms in my app.</p>
<p>What we need is a “Windows Lie Detector” to make sure Windows stops lying to us.</p>
<p>How do we do this?</p>
<p>We need to tell Windows that the app is “DPI Aware”.</p>
<p>And that&#8217;s exactly what we&#8217;ll look at in tomorrow&#8217;s post.</p>
<p>&nbsp;</p>
<h3>Related Links (With much better explanations)</h3>
<p><a title="A much better explanation" href="http://www.kynosarges.org/WindowsDpi.html" target="_blank">High DPI Settings In Windows<br />
</a><a title="Fixing Windows Programming" href="http://news.kynosarges.org/2012/07/10/fixing-windows-programming/" target="_blank">Fixing Windows Programming</a></p>
<p>&nbsp;</p>
			</div><!-- .entry-content -->

</article><!-- #post-## -->

			
				<nav class="navigation paging-navigation" role="navigation">
		<h1 class="screen-reader-text">Posts navigation</h1>
		<div class="nav-links">

							<div class="nav-previous"><a href="/tag/foxpro/page/2/" class="button"><span class="meta-nav"><i class="fa fa-arrow-circle-o-left"></i> Older posts</span></a></div>
			
			
		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
		
		</main><!-- #main -->
	</section><!-- #primary -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info">
			<a class="powered-by" href="http://wordpress.org/">Proudly powered by WordPress</a>
			<span class="sep"> | </span>
			Theme: editor by <a href="https://array.is/">Array</a>		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	<div style="display:none">
	</div>
<script type='text/javascript' src='/wp-content/plugins/jetpack/modules/photon/photon.js?ver=20130122'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201725'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2017Junaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.8'></script>
<script type='text/javascript' src='/wp-content/themes/editor/js/jquery.fitvids.js?ver=20140820'></script>
<script type='text/javascript' src='/wp-content/themes/editor/js/editor.js?ver=20120206'></script>
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.8'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"kevinragsdale"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/disqus-comment-system/media/js/count.js?ver=4.8'></script>
<script type='text/javascript' src='https://stats.wp.com/e-201725.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:5.0',blog:'34471053',post:'0',tz:'-5',srv:'kevinragsdale.net'} ]);
	_stq.push([ 'clickTrackerInit', '34471053', '0' ]);
</script>

</body>
</html>
