<!doctype html>
<html amp lang="en-US">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
		<title>Subclassing Visual FoxPro Base Classes: Label Control</title>
		<link rel="canonical" href="/subclassing-visual-foxpro-base-classes-label-control/" />
		<script src="https://cdn.ampproject.org/v0.js" async></script>
			<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic">
		<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
		<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"BlogPosting","mainEntityOfPage":"\/subclassing-visual-foxpro-base-classes-label-control\/","publisher":{"@type":"Organization","name":"Kevin Ragsdale"},"headline":"Subclassing Visual FoxPro Base Classes: Label Control","datePublished":"2013-01-15T22:14:21+00:00","dateModified":"2013-01-15T22:14:21+00:00","author":{"@type":"Person","name":"Kevin Ragsdale"},"image":{"@type":"ImageObject","url":"https:\/\/i2.wp.com\/kevinragsdale.net\/wp-content\/uploads\/2013\/01\/lblLabel.png?fit=524%2C342&ssl=1","width":524,"height":342}}</script>
		<style amp-custom>
		/* Generic WP styling */

.alignright {
	float: right;
}

.alignleft {
	float: left;
}

.aligncenter {
	display: block;
	margin-left: auto;
	margin-right: auto;
}

.amp-wp-enforced-sizes {
	/** Our sizes fallback is 100vw, and we have a padding on the container; the max-width here prevents the element from overflowing. **/
	max-width: 100%;
	margin: 0 auto;
}

.amp-wp-unknown-size img {
	/** Worst case scenario when we can't figure out dimensions for an image. **/
	/** Force the image into a box of fixed dimensions and use object-fit to scale. **/
	object-fit: contain;
}

/* Template Styles */

.amp-wp-content,
.amp-wp-title-bar div {
		margin: 0 auto;
	max-width: 730px;
	}

html {
	background: #0a89c0;
}

body {
	background: #fff;
	color: #353535;
	font-family: 'Merriweather', 'Times New Roman', Times, Serif;
	font-weight: 300;
	line-height: 1.75em;
}

p,
ol,
ul,
figure {
	margin: 0 0 1em;
	padding: 0;
}

a,
a:visited {
	color: #0a89c0;
}

a:hover,
a:active,
a:focus {
	color: #353535;
}

/* Quotes */

blockquote {
	color: #353535;
	background: rgba(127,127,127,.125);
	border-left: 2px solid #0a89c0;
	margin: 8px 0 24px 0;
	padding: 16px;
}

blockquote p:last-child {
	margin-bottom: 0;
}

/* UI Fonts */

.amp-wp-meta,
.amp-wp-header div,
.amp-wp-title,
.wp-caption-text,
.amp-wp-tax-category,
.amp-wp-tax-tag,
.amp-wp-comments-link,
.amp-wp-footer p,
.back-to-top {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen-Sans", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif;
}

/* Header */

.amp-wp-header {
	background-color: #0a89c0;
}

.amp-wp-header div {
	color: #fff;
	font-size: 1em;
	font-weight: 400;
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: .875em 16px;
	position: relative;
}

.amp-wp-header a {
	color: #fff;
	text-decoration: none;
}

/* Site Icon */

.amp-wp-header .amp-wp-site-icon {
	/** site icon is 32px **/
	background-color: #fff;
	border: 1px solid #fff;
	border-radius: 50%;
	position: absolute;
	right: 18px;
	top: 10px;
}

/* Article */

.amp-wp-article {
	color: #353535;
	font-weight: 400;
	margin: 1.5em auto;
	max-width: 840px;
	overflow-wrap: break-word;
	word-wrap: break-word;
}

/* Article Header */

.amp-wp-article-header {
	align-items: center;
	align-content: stretch;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	margin: 1.5em 16px 1.5em;
}

.amp-wp-title {
	color: #353535;
	display: block;
	flex: 1 0 100%;
	font-weight: 900;
	margin: 0 0 .625em;
	width: 100%;
}

/* Article Meta */

.amp-wp-meta {
	color: #696969;
	display: inline-block;
	flex: 2 1 50%;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: 0;
}

.amp-wp-article-header .amp-wp-meta:last-of-type {
	text-align: right;
}

.amp-wp-article-header .amp-wp-meta:first-of-type {
	text-align: left;
}

.amp-wp-byline amp-img,
.amp-wp-byline .amp-wp-author {
	display: inline-block;
	vertical-align: middle;
}

.amp-wp-byline amp-img {
	border: 1px solid #0a89c0;
	border-radius: 50%;
	position: relative;
	margin-right: 6px;
}

.amp-wp-posted-on {
	text-align: right;
}

/* Featured image */

.amp-wp-article-featured-image {
	margin: 0 0 1em;
}
.amp-wp-article-featured-image amp-img {
	margin: 0 auto;
}
.amp-wp-article-featured-image.wp-caption .wp-caption-text {
	margin: 0 18px;
}

/* Article Content */

.amp-wp-article-content {
	margin: 0 16px;
}

.amp-wp-article-content ul,
.amp-wp-article-content ol {
	margin-left: 1em;
}

.amp-wp-article-content amp-img {
	margin: 0 auto;
}

.amp-wp-article-content amp-img.alignright {
	margin: 0 0 1em 16px;
}

.amp-wp-article-content amp-img.alignleft {
	margin: 0 16px 1em 0;
}

/* Captions */

.wp-caption {
	padding: 0;
}

.wp-caption.alignleft {
	margin-right: 16px;
}

.wp-caption.alignright {
	margin-left: 16px;
}

.wp-caption .wp-caption-text {
	border-bottom: 1px solid #c2c2c2;
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 0;
	padding: .66em 10px .75em;
}

/* AMP Media */

amp-carousel {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}
amp-iframe,
amp-youtube,
amp-instagram,
amp-vine {
	background: #c2c2c2;
	margin: 0 -16px 1.5em;
}

.amp-wp-article-content amp-carousel amp-img {
	border: none;
}

amp-carousel > amp-img > img {
	object-fit: contain;
}

.amp-wp-iframe-placeholder {
	background: #c2c2c2 url( /wp-content/plugins/amp/assets/images/placeholder-icon.png) no-repeat center 40%;
	background-size: 48px 48px;
	min-height: 48px;
}

/* Article Footer Meta */

.amp-wp-article-footer .amp-wp-meta {
	display: block;
}

.amp-wp-tax-category,
.amp-wp-tax-tag {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	margin: 1.5em 16px;
}

.amp-wp-comments-link {
	color: #696969;
	font-size: .875em;
	line-height: 1.5em;
	text-align: center;
	margin: 2.25em 0 1.5em;
}

.amp-wp-comments-link a {
	border-style: solid;
	border-color: #c2c2c2;
	border-width: 1px 1px 2px;
	border-radius: 4px;
	background-color: transparent;
	color: #0a89c0;
	cursor: pointer;
	display: block;
	font-size: 14px;
	font-weight: 600;
	line-height: 18px;
	margin: 0 auto;
	max-width: 200px;
	padding: 11px 16px;
	text-decoration: none;
	width: 50%;
	-webkit-transition: background-color 0.2s ease;
			transition: background-color 0.2s ease;
}

/* AMP Footer */

.amp-wp-footer {
	border-top: 1px solid #c2c2c2;
	margin: calc(1.5em - 1px) 0 0;
}

.amp-wp-footer div {
	margin: 0 auto;
	max-width: calc(840px - 32px);
	padding: 1.25em 16px 1.25em;
	position: relative;
}

.amp-wp-footer h2 {
	font-size: 1em;
	line-height: 1.375em;
	margin: 0 0 .5em;
}

.amp-wp-footer p {
	color: #696969;
	font-size: .8em;
	line-height: 1.5em;
	margin: 0 85px 0 0;
}

.amp-wp-footer a {
	text-decoration: none;
}

.back-to-top {
	bottom: 1.275em;
	font-size: .8em;
	font-weight: 600;
	line-height: 2em;
	position: absolute;
	right: 16px;
}
		/* Inline styles */
.amp-wp-inline-547a08ae65fc7bbc88895fe7940b08b1{font-size:26px;font-weight:bold;line-height:1.3846153846;}	</style>
</head>

<body class="">

<header id="#top" class="amp-wp-header"><div><a href="/">Kevin Ragsdale: Visual FoxPro 9.0</a></div></header>

<article class="amp-wp-article">

	<header class="amp-wp-article-header">
		<h1 class="amp-wp-title">Subclassing Visual FoxPro Base Classes: Label Control</h1>
				<div class="amp-wp-meta amp-wp-byline">
					<amp-img src="https://secure.gravatar.com/avatar/312fca19660d3ccc712d9a90106dadd3?s=24&#038;d=mm&#038;r=g" width="24" height="24" layout="fixed"></amp-img>
				<span class="amp-wp-author author vcard">Kevin Ragsdale</span>
	</div>
<div class="amp-wp-meta amp-wp-posted-on">
	<time datetime="2013-01-15T22:14:21+00:00">January 15, 2013</time>
</div>
	</header>

	
	<div class="amp-wp-article-content">
		<p><strong>Updated December 16, 2013: Source code for lblLabel is <a title="lblLabel Source Code" href="/source-code-lbllabel-visual-foxpro-label-subclass/">available here</a>.</strong></p>
<p>The next few blog posts will look at subclassing the Visual FoxPro base classes, with an emphasis on UI design as it relates to Microsoft’s User Experience Interaction Guidelines (or UX Guide). Since the emphasis is on playing well with Windows, I’ll assume that my apps will be using Themes when available at the OS-level.</p>
<p><span class="amp-wp-inline-547a08ae65fc7bbc88895fe7940b08b1">Subclassing the Visual FoxPro Label Control</span></p>
<p>Typically, I stick to the following default properties for labels:</p>
<pre>AutoSize = .T.
BackStyle = 0 (Transparent) 
FontName = "Segoe UI" (Default for my development OS) 
FontSize = 9 (Default for my development OS)</pre>
<p>Though I <a title="Respecting The User’s Font Settings" href="/respecting-the-users-font-settings/" target="_blank">typically use</a> “Segoe UI” as the FontName, since I’m currently <a title="Have You Seen My Segoe?" href="/have-you-seen-my-segoe/" target="_blank">using Windows 8</a> I’m actually going to use “Segoe UI Symbol” in the Properties window, and change it to Segoe UI in code for the class.</p>
<p>I use AutoSize because I may need to change the font name and/or size, depending on the version of Windows the app is running on, and I use the default font and size for the OS on my development machine. This makes form design much easier for me. I also set the label BackStyle to transparent to prevent it from having a “gray” backcolor if the label is placed on a control (or form) that is not using a “default” color.</p>
<p>I consider label controls to be equivalent to “text” in Microsoft-speak. As long as we’re discussing labels (and text), let’s talk a little about fonts and font sizes.</p>
<p>The <a title="Windows User Experience Interaction Guidelines for Windows Desktop" href="http://msdn.microsoft.com/en-us/windows/desktop/aa511258.aspx" target="_blank">Microsoft UX Guide</a> contains the following recommendations for fonts and font sizes:</p>
<table><thead><tr><th>Operating System</th>
<th>Font (size)</th>
</tr></thead><tbody><tr><td>Windows Vista and later</td>
<td>Segoe UI (9pt)</td>
</tr><tr><td>Pre-Windows Vista</td>
<td>Tahoma (8pt)</td>
</tr></tbody></table><p>The guide also provides (on pages 620-624) some default color information and sizes for various types of text (or Labels) you may have in the app. We will use these for some additional subclasses of our label.</p>
<h2>The lblLabel Class</h2>
<p>Based on this information, I’ve created a subclass of Label (named lblLabel) with the following properties:</p>
<pre>AutoSize = .T.
FontName = "Segoe UI Symbol"
BackStyle = 0
Caption = "lblLabel"
Height = 17
Width = 43
Name = "lblLabel"</pre>
<p>Since Segoe UI is a newer font introduced in Windows Vista, computers running Windows XP may not have this font available (even if an XP machine does have Segoe UI, it can sometimes be rendered kind of blurry on XP, so I usually stick with Tahoma for pre-Vista versions of Windows anyway).</p>
<p>Since the UX Guide recommends “Tahoma, 8” as the pre-Vista default, and since my Segoe UI has disappeared from my Properties window in Windows 8, I’ve added the following code to the Init() method:</p>
<pre>** Are we running a pre-Vista version of Windows?
IF VAL(OS(3)) &lt; 6 &amp;&amp; Windows Pre-Vista (XP, 2000, etc)
   ** Set the default font to Tahoma. Plus,
   ** if the font size is set to the Vista
   ** default (9pt), set it to 8pt. If it is not
   ** the default, let's make it 1pt smaller.
   This.FontName = "Tahoma"
   This.FontSize = IIF(This.FontSize=9,8,This.FontSize-1)
ELSE
   ** On my Windows 8 machine, Segoe UI is not
   ** available in the Properties window, so I 
   ** had to choose Segoe UI Symbol. We'll do
   ** the switch to Segoe UI here.
   This.FontName = "Segoe UI"
   This.FontSize = 9
ENDIF</pre>
<p>Even though users normally don’t “click” on Labels, some additional subclassed labels we’ll cover later (think hyperlinks) <em>do</em> have clickable interactions, so I’ve added the following code to the Click event for the label :</p>
<pre>PROCEDURE Click
   ** Code in methods, not events!
   This.OnClick()
ENDPROC</pre>
<p>With this, I’ve told the label to call an abstract method in the label class called OnClick. Since it’s an abstract method, we’ll leave it empty in this class, but we will use it later.</p>
<pre>PROCEDURE OnClick
   ** Abstract method called by the Click() event
ENDPROC</pre>
<p>And we’re all set and ready to drop an instance of our label on a form!</p>
<p>But, there’s some additional considerations…</p>
<p>Some of our subclasses of this Label control will be set to use colors other than the “Default” colors found in the Visual FoxPro Properties window. While these different-colored labels will look fine in most instances, there are times I might want the Label (or “text”) to revert back to the <a title="So, What Are The “Default” Colors Anyway?" href="/so-what-are-the-default-colors-anyway/" target="_blank">Windows System Color</a>.</p>
<p>We’ll look at those instances in a future post.</p>
	</div>

	<footer class="amp-wp-article-footer">
			<div class="amp-wp-meta amp-wp-tax-category">
		Categories: <a href="/category/tips-and-tricks-to-improve-your-apps-ui/" rel="category tag">It's So, Uh, Gray</a>	</div>

	<div class="amp-wp-meta amp-wp-tax-tag">
		Tags: <a href="/tag/class/" rel="tag">class</a>, <a href="/tag/label/" rel="tag">label</a>, <a href="/tag/subclass/" rel="tag">subclass</a>, <a href="/tag/text/" rel="tag">text</a>, <a href="/tag/visual-foxpro-2/" rel="tag">visual foxpro</a>, <a href="/tag/windows/" rel="tag">windows</a>	</div>
	</footer>

</article>

<footer class="amp-wp-footer">
	<div>
		
		<p>
			&copy; 2013 Kevin Ragsdale
		</p>
		<a href="#top" class="back-to-top">Back to top</a>
	</div>
</footer>

	
	
</body>
</html>
